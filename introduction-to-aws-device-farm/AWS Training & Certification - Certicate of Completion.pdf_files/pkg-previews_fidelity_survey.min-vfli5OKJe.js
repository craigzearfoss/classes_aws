define("modules/clean/react/previews/fidelity_survey/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.Initial="initial",e.NegativeFollowup="negative_followup",e.PositiveFollowup="positive_followup"})(t.QuestionId||(t.QuestionId={})),(function(e){e.VeryDissatisfied="initial_very_dissatisfied",e.Dissatisfied="initial_dissatisfied",e.Neutral="initial_neutral",e.Satisfied="initial_satisfied",e.VerySatisfied="initial_very_satisfied"})(t.InitialResponseId||(t.InitialResponseId={})),(function(e){e.CancelClick="cancel",e.OverlayClick="overlay"})(t.DismissalMethod||(t.DismissalMethod={})),t.OTHER_RESPONSE_ID="other"})),define("modules/clean/react/previews/fidelity_survey/fidelity_survey_bar",["require","exports","tslib","classnames","modules/clean/react/previews/fidelity_survey/strings","modules/clean/react/previews/fidelity_survey/constants","modules/clean/react/previews/fidelity_survey/utils","modules/clean/static_urls","modules/core/i18n","react","spectrum/button","spectrum/tooltip"],(function(e,t,s,o,i,n,r,a,l,u,c,d){"use strict";var p;Object.defineProperty(t,"__esModule",{value:!0}),o=s.__importDefault(o),u=s.__importStar(u);var h=function(e){return a.static_url("/static/images/fidelity_survey/"+e)},m=((p={})[n.InitialResponseId.VeryDissatisfied]=h("very_dissatisfied.png"),p[n.InitialResponseId.Dissatisfied]=h("dissatisfied.png"),p[n.InitialResponseId.Neutral]=h("neutral.png"),p[n.InitialResponseId.Satisfied]=h("satisfied.png"),p[n.InitialResponseId.VerySatisfied]=h("very_satisfied.png"),p),y=function(e){var t=e.isSelected,s=void 0!==t&&t,n=e.onClick,r=e.responseId;return u.createElement("div",{className:o.default("fidelity-survey-bar__option",{"fidelity-survey-bar__option--selected":s})},u.createElement(d.Tooltip,{tooltipContent:i.INITIAL_RESPONSES[r]},u.createElement(c.Button,{variant:"styleless",className:"fidelity-survey-bar__option-button",onClick:n},u.createElement("img",{className:"fidelity-survey-bar__option-button-img",src:m[r],alt:i.INITIAL_RESPONSES[r]}))))};t.FidelitySurveyBar=function(e){var t=e.onDismiss,s=e.onSubmit,o=e.selectedResponse;return e.open?u.createElement("div",{className:"fidelity-survey-bar"},i.QUESTIONS[n.QuestionId.Initial],u.createElement("div",{className:"fidelity-survey-bar__response-buttons"},Object.keys(i.INITIAL_RESPONSES).map((function(e){return u.createElement(y,{key:e,responseId:e,isSelected:o===e,onClick:function(){var t;return s({order:r.idListToOrderMap(Object.keys(i.INITIAL_RESPONSES)),values:(t={},t[e]="checked",t)})}})}))),u.createElement(c.Button,{className:"fidelity-survey-bar__close-button",variant:"styleless",onClick:t},l._("Close",{comment:"Text on a close button"}))):null}})),define("modules/clean/react/previews/fidelity_survey/fidelity_survey_component",["require","exports","tslib","modules/clean/file_store/utils","modules/clean/loggers/file_preview_logger","modules/clean/react/css","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/file_viewer/models","modules/clean/react/previews/fidelity_survey/constants","modules/clean/react/previews/fidelity_survey/fidelity_survey_bar","modules/clean/react/previews/fidelity_survey/fidelity_survey_modal","modules/clean/react/previews/fidelity_survey/utils","modules/clean/react/snackbar","modules/core/i18n","react"],(function(e,t,s,o,i,n,r,a,l,u,c,d,p,h,m,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),y=s.__importDefault(y);var f={thankYou:m._("Thanks. Your feedback will help improve Dropbox.",{comment:"Message shown to users in a snackbar after they submit a feedback survey."})};function v(e,t){var s=l.FilePreviewSession.currentSession;a.filePreviewEventEmitter.emit(e,s,t)}var _=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isBarOpen:!0,isModalOpen:!1},t.onBarSubmit=function(e){v(r.EventType.FilePreviewFidelitySurveyAnswered,s.__assign(s.__assign({},e),{question_id:u.QuestionId.Initial}));var o=Object.keys(e.values)[0],i=p.getFollowupQuestionId(o),n=p.getFollowupResponses(i,t.props.file);n?t.setState({barSubmission:e,followUpQuestionId:i,followUpResponses:n,isModalOpen:!0}):(t.closeBarAndModal(),h.Snackbar.complete(f.thankYou,"fidelity-survey"))},t.onBarDismiss=function(){v(r.EventType.FilePreviewFidelitySurveyDismissed,{question_id:u.QuestionId.Initial}),t.closeBarAndModal()},t.handleModalSubmit=function(e,o){if(t.state.followUpQuestionId){var i=t.props.file,n=t.props.allowFileDonation&&o?{_file_nsid:i.ns_id,_file_sjid:i.sjid}:{};v(r.EventType.FilePreviewFidelitySurveyAnswered,s.__assign(s.__assign({question_id:t.state.followUpQuestionId},e),n))}t.closeBarAndModal(),h.Snackbar.complete(f.thankYou,"fidelity-survey")},t.handleModalDismiss=function(e){t.state.followUpQuestionId&&v(r.EventType.FilePreviewFidelitySurveyDismissed,{question_id:t.state.followUpQuestionId,dismissal_method:e}),t.closeBarAndModal()},t}return s.__extends(t,e),t.prototype.componentDidMount=function(){this.logger=new i.FilePreviewFidelitySurveyLogger,this.logger.listenTo(a.filePreviewEventEmitter),v(r.EventType.FilePreviewFidelitySurveyAsked)},t.prototype.componentWillUnmount=function(){this.logger.unlistenTo(a.filePreviewEventEmitter)},t.prototype.closeBarAndModal=function(){this.setState({isBarOpen:!1,isModalOpen:!1})},t.prototype.render=function(){var e,t=this.props,s=t.allowFileDonation,i=t.file,n=this.state,r=n.barSubmission,a=n.followUpQuestionId,l=n.followUpResponses,u=n.isBarOpen,p=n.isModalOpen;return r&&(e=Object.keys(r.values)[0]),y.default.createElement("div",null,y.default.createElement(c.FidelitySurveyBar,{onSubmit:this.onBarSubmit,onDismiss:this.onBarDismiss,selectedResponse:e,open:u}),y.default.createElement(d.FidelitySurveyModal,{allowFileDonation:s,filename:o.getFilename(i),onDismiss:this.handleModalDismiss,onSubmit:this.handleModalSubmit,questionId:a,responses:l,open:p}))},t})(y.default.Component);t.FidelitySurveyWithoutCSS=_;var w=n.requireCssWithComponent(_,["/static/css/fidelity_survey/fidelity_survey-vflSJ2iNF.css"]);t.FidelitySurvey=w})),define("modules/clean/react/previews/fidelity_survey/fidelity_survey_modal",["require","exports","tslib","external/lodash","modules/clean/react/previews/fidelity_survey/constants","modules/clean/react/previews/fidelity_survey/fidelity_survey_modal_form","modules/clean/react/previews/fidelity_survey/strings","modules/clean/react/previews/fidelity_survey/utils","modules/core/i18n","react","spectrum/modal/utility_modal"],(function(e,t,s,o,i,n,r,a,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=s.__importStar(o),u=s.__importDefault(u);var d={modalTitle:l._("Thank you for the feedback",{comment:"Title shown in the header of a feedback modal after the user has indicated their satisfaction level with web previews"}),otherSurveyResponseLabel:l._("Other",{comment:'This is a label In a survey form a user will be prompted with several options. One of them will be "Other" to allow them to enter a free formed response'}),cancelSurveyButton:l._("Cancel",{comment:"Used on the cancel button inside of a modal that has a survey form."}),submitSurveyButton:l._("Submit",{comment:"Used on the submit button inside of a modal that has a survey form."}),modalAriaLabel:l._("Preview Feedback Survey",{comment:"Aria label shown on the preview survey modal."})};var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isFileDonationChecked:!1,otherResponse:{checked:!1,message:d.otherSurveyResponseLabel,value:""},responseMap:{}},t.handleResponseChange=function(e,o,n){var r;e===i.OTHER_RESPONSE_ID?t.handleOtherResponseChange(o,n):t.setState({responseMap:s.__assign(s.__assign({},t.state.responseMap),(r={},r[e]=s.__assign(s.__assign({},t.state.responseMap[e]),{checked:o}),r))})},t.handleFileDonationChange=function(e){t.setState({isFileDonationChecked:e})},t.handlePrimaryAction=function(){var e=Object.keys(t.state.responseMap),s={order:a.idListToOrderMap(e),values:{}};e.forEach((function(e){t.state.responseMap[e].checked&&(s.values[e]="checked")})),t.state.otherResponse.checked&&t.state.otherResponse.value&&(s.values[i.OTHER_RESPONSE_ID]=t.state.otherResponse.value),t.props.onSubmit(s,t.state.isFileDonationChecked)},t.handleSecondaryAction=function(){t.props.onDismiss(i.DismissalMethod.CancelClick)},t.handleRequestClose=function(){t.props.onDismiss(i.DismissalMethod.OverlayClick)},t}return s.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){var t,s;e.responses&&e.responses!==this.props.responses&&this.setState({responseMap:(t=e.responses,s={},o.shuffle(Object.keys(t)).forEach((function(e){s[e]={message:t[e],checked:!1}})),s)})},t.prototype.handleOtherResponseChange=function(e,t){var o=s.__assign(s.__assign({},this.state.otherResponse),{checked:e});void 0!==t&&(o.value=t),o.value!==this.state.otherResponse.value&&(o.checked?""===o.value&&(o.checked=!1):o.checked=!0),this.setState({otherResponse:o})},t.prototype.render=function(){var e=this.props.allowFileDonation&&this.props.questionId===i.QuestionId.NegativeFollowup,t=this.props,s=t.filename,o=t.open,a=t.questionId,l=this.state,p=l.isFileDonationChecked,h=l.otherResponse,m=l.responseMap;return u.default.createElement(c.UtilityModal,{appElement:document.querySelector(".react-file-viewer"),ariaLabel:d.modalAriaLabel,onPrimaryAction:this.handlePrimaryAction,onRequestClose:this.handleRequestClose,onSecondaryAction:this.handleSecondaryAction,open:o,overlayClassName:"file-viewer-modal-overlay",overlayClickClose:!0,primaryAction:d.submitSurveyButton,secondaryAction:d.cancelSurveyButton,shouldRequestCloseOnActions:!1,title:a?r.QUESTIONS[a]:""},u.default.createElement(n.FidelitySurveyModalForm,{allowFileDonation:e,filename:s,isFileDonationChecked:p,onFileDonationChange:this.handleFileDonationChange,onResponseChange:this.handleResponseChange,otherResponse:h,responses:m}))},t})(u.default.Component);t.FidelitySurveyModal=p})),define("modules/clean/react/previews/fidelity_survey/fidelity_survey_modal_form",["require","exports","tslib","modules/clean/em_string","modules/clean/filepath","modules/clean/react/previews/fidelity_survey/constants","modules/core/i18n","react","spectrum/checkbox","spectrum/file_icon","spectrum/input"],(function(e,t,s,o,i,n,r,a,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=s.__importStar(i),a=s.__importDefault(a);var d={disclaimer:r._("The Dropbox team will review your document. It will only be used to help improve previews.",{comment:"Disclaimer shown to users in a feedback modal below an option to donate their file"}),formQuestion:r._("Please select all that apply.",{comment:"Prompt show above a list of possible responses to a survey."})};t.ResponseList=function(e){var t=e.responses,s=e.onResponseChange,o=e.otherResponse;return a.default.createElement("ul",{className:"fidelity-survey-modal-form__responses"},Object.keys(t).map((function(e){var o=t[e],i=o.checked,n=o.message,r=i?"checked":"unchecked";return a.default.createElement("li",{key:e,className:"fidelity-survey-modal-form__response"},a.default.createElement(l.Checkbox,{id:e,checked:r,onChange:function(t){return s(e,"checked"===t)}}),a.default.createElement("label",{htmlFor:e,className:"fidelity-survey-modal-form__response-label"},n))})),a.default.createElement("li",{className:"fidelity-survey-modal-form__response"},a.default.createElement(l.Checkbox,{id:n.OTHER_RESPONSE_ID,checked:o.checked?"checked":"unchecked",onChange:function(e){return s(n.OTHER_RESPONSE_ID,"checked"===e)}}),a.default.createElement("label",{htmlFor:n.OTHER_RESPONSE_ID,className:"fidelity-survey-modal-form__response-label"},a.default.createElement(c.Input,{className:"fidelity-survey-modal-form__input",placeholder:o.message,value:o.value,onClick:function(e){e.preventDefault()},onChange:function(e){return s(n.OTHER_RESPONSE_ID,o.checked,e.currentTarget.value)}}))))},t.FileDonation=function(e){var t=e.isFileDonationChecked,s=e.onFileDonationChange,n=e.filename;return a.default.createElement("label",{className:"fidelity-survey-modal-form__donation",htmlFor:"file-donation"},a.default.createElement(l.Checkbox,{id:"file-donation",checked:t?"checked":"unchecked",onChange:function(e){return s("checked"===e)}}),a.default.createElement(u.FileIcon,{className:"fidelity-survey-modal-form__donation-icon",path:n}),a.default.createElement("div",{className:"fidelity-survey-modal-form__donation-meta"},a.default.createElement("p",{className:"fidelity-survey-modal-form__donation-name"},r.intl.formatMessage(r._("Include <b>%(filename)s</b>"),{filename:o.Emstring.em_snippet(i.filename(n),32),b:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("b",null,e)}})),a.default.createElement("p",{className:"fidelity-survey-modal-form__donation-disclaimer"},d.disclaimer)))},t.FidelitySurveyModalForm=function(e){return a.default.createElement("div",{className:"fidelity-survey-modal-form"},a.default.createElement("p",{className:"fidelity-survey-modal-form__question"},d.formQuestion),a.default.createElement(t.ResponseList,s.__assign({},e)),e.allowFileDonation&&a.default.createElement(t.FileDonation,s.__assign({},e)))}})),define("modules/clean/react/previews/fidelity_survey/strings",["require","exports","tslib","modules/clean/react/previews/fidelity_survey/constants","modules/core/i18n"],(function(e,t,s,o,i){"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0});var a=["doc","docx"],l=["ppt","pptx"],u=["epub"];t.QUESTIONS=((n={})[o.QuestionId.Initial]=i._("How happy are you with this file preview?",{comment:"Prompt shown next to list of emoji buttons (ranging from very happy to very unhappy) so we can gather feedback on preview fidelity."}),n[o.QuestionId.PositiveFollowup]=i._("Why are you previewing this file?",{comment:"Prompt shown to a user to try to understand why they are previewing files on the web. They will be shown a list of possible reasons that they can then check off and submit."}),n[o.QuestionId.NegativeFollowup]=i._("Are you encountering any issues with this file preview?",{comment:"Prompt shown to a user if they are not happy with the file preview. They will be shown a list of possible problems that they can then check off and submit."}),n),t.INITIAL_RESPONSES=((r={})[o.InitialResponseId.VeryDissatisfied]=i._("Not at all happy",{comment:"Tooltip text above a very unhappy emoji. >:("}),r[o.InitialResponseId.Dissatisfied]=i._("Not happy",{comment:"Tooltip text above a somewhat unhappy emoji. E.g. :("}),r[o.InitialResponseId.Neutral]=i._("Neutral",{comment:"Tooltip text above a emoji that has a neutral expression. E.g. :|"}),r[o.InitialResponseId.Satisfied]=i._("Happy",{comment:"Tooltip text above a somewhat happy emoji. E.g. :)"}),r[o.InitialResponseId.VerySatisfied]=i._("Very happy",{comment:"Tooltip text above a very happy emoji. E.g. :D"}),r),t.PositiveFollowupResponses={positive_add_comments:i._("Make comments",{comment:'Possible user response to the question "Why are you previewing this file?"'}),positive_collaborate:i._("@mention someone on my team",{comment:'Possible user response to the question "Why are you previewing this file?"'}),positive_correct_file:i._("Check if itâ€™s the right file",{comment:'Possible user response to the question "Why are you previewing this file?"'}),positive_download:i._("Download the file",{comment:'Possible user response to the question "Why are you previewing this file?"'}),positive_present:i._("Present work to my team or clients",{comment:'Possible user response to the question "Why are you previewing this file?"'}),positive_share:i._("Share the file with others",{comment:'Possible user response to the question "Why are you previewing this file?"'}),positive_view_content:i._("View the file contents",{comment:'Possible user response to the question "Why are you previewing this file?"'})};var c,d,p={ppt_colors:i._("Colors",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web powerpoint preview. A user may select this option to indicate that the colors are not correct."}),ppt_scale:i._("Too zoomed in/out",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web powerpoint preview. A user may select this option to indicate that the scale is not correct."}),ppt_fonts:i._("Fonts",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web powerpoint preview. A user may select this option to indicate that the fonts are not correct."}),ppt_interactives:i._("Videos/Images",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web powerpoint preview. A user may select this option to indicate that videos/images are not loading/working."}),ppt_layout:i._("Layout",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web powerpoint preview. A user may select this option to indicate that the layout (within the file) is not rendering correctly."}),ppt_tables:i._("Tables",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web powerpoint preview. A user may select this option to indicate that tables are not rendering correctly."})},h={word_colors:i._("Colors",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web word doc preview. A user may select this option to indicate that the colors are not correct."}),word_fonts:i._("Fonts",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web word doc preview. A user may select this option to indicate that the fonts are not correct."}),word_language:i._("Unreadable Text",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web word doc preview. A user may select this option to indicate that the text is in another language or is generally unreadable."}),word_layout:i._("Layout",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web word doc preview. A user may select this option to indicate that the layout (within the file) is not rendering correctly."}),word_line_spacing:i._("Spacing between lines",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web word doc preview. A user may select this option to indicate that the line spacing of their text is not correct."}),word_margin:i._("Margins",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web word doc preview. A user may select this option to indicate that their margins are not rendering correctly."})},m={epub_colors:i._("Colors",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web epub doc preview. A user may select this option to indicate that the colors are not correct."}),epub_fonts:i._("Fonts",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web epub doc preview. A user may select this option to indicate that the fonts are not correct."}),epub_language:i._("Unreadable text",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web epub doc preview. A user may select this option to indicate that the text is in another language or is generally unreadable."}),epub_layout:i._("Layout",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web epub doc preview. A user may select this option to indicate that the layout (within the file) is not rendering correctly."}),epub_line_spacing:i._("Spacing between lines",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web epub doc preview. A user may select this option to indicate that the line spacing of their text is not correct."}),epub_margin:i._("Margins",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web epub doc preview. A user may select this option to indicate that their margins are not rendering correctly."}),epub_pagination:i._("Unexpected pagination",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web epub doc preview. A user may select this option to indicate that the pagination is not correct."}),epub_images:i._("Images",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web epub doc preview. A user may select this option to indicate that the images are not rendering correctly."}),epub_tables:i._("Tables",{comment:"Possible survey response shown to a user for us to try to understand what issue(s) they are encountering with their web epub doc preview. A user may select this option to indicate that the tables are not rendering correctly."})};t.NegativeFollowupResponsesByExtension=(c={},d=function(e,t){var o;c=s.__assign(s.__assign({},c),((o={})[e]=t,o))},l.forEach((function(e){return d(e,p)})),a.forEach((function(e){return d(e,h)})),u.forEach((function(e){return d(e,m)})),c)})),define("modules/clean/react/previews/fidelity_survey/utils",["require","exports","tslib","modules/clean/file_store/utils","modules/clean/react/previews/fidelity_survey/constants","modules/clean/react/previews/fidelity_survey/strings"],(function(e,t,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFollowupQuestionId=function(e){switch(e){case i.InitialResponseId.VerySatisfied:case i.InitialResponseId.Satisfied:return i.QuestionId.PositiveFollowup;default:return i.QuestionId.NegativeFollowup}},t.getFollowupResponses=function(e,t){var s=o.getExtension(t);switch(e){case i.QuestionId.PositiveFollowup:return n.PositiveFollowupResponses;case i.QuestionId.NegativeFollowup:return n.NegativeFollowupResponsesByExtension[s];default:return}},t.idListToOrderMap=function(e){return e.reduce((function(e,t,o){var i;return s.__assign(s.__assign({},e),((i={})[t]=o,i))}),{})}}));
//# sourceMappingURL=pkg-previews_fidelity_survey.min.js-vflW7_n5c.map