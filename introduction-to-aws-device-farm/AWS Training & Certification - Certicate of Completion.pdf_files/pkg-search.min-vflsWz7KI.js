define("modules/clean/logging/hive/schemas/search-web_search_activity",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){this.category="search-web_search_activity",this.active_user_id=null,this.anon_ip=null,this.authed_user_ids=null,this.country=null,this.identity_gid=null,this.locale_browser_header=null,this.locale_user_selected=null,this.referrer=null,this.session_id=null,this.team_id=null,this.team_type=null,this.ua_browser_name=null,this.ua_browser_version=null,this.ua_dist_name=null,this.ua_dist_version=null,this.ua_os_name=null,this.ua_os_version=null,this.user_agent=null,this.user_id=null,e.hasOwnProperty("action_type")&&void 0!==e.action_type&&(this.action_type=e.action_type),e.hasOwnProperty("active_user_id")&&void 0!==e.active_user_id&&(this.active_user_id=e.active_user_id),e.hasOwnProperty("anon_ip")&&void 0!==e.anon_ip&&(this.anon_ip=e.anon_ip),e.hasOwnProperty("authed_user_ids")&&void 0!==e.authed_user_ids&&(this.authed_user_ids=e.authed_user_ids),e.hasOwnProperty("country")&&void 0!==e.country&&(this.country=e.country),e.hasOwnProperty("deleted_filter")&&void 0!==e.deleted_filter&&(this.deleted_filter=e.deleted_filter),e.hasOwnProperty("deleted")&&void 0!==e.deleted&&(this.deleted=e.deleted),e.hasOwnProperty("event_name")&&void 0!==e.event_name&&(this.event_name=e.event_name),e.hasOwnProperty("extra")&&void 0!==e.extra&&(this.extra=e.extra),e.hasOwnProperty("failure_type")&&void 0!==e.failure_type&&(this.failure_type=e.failure_type),e.hasOwnProperty("file_extension")&&void 0!==e.file_extension&&(this.file_extension=e.file_extension),e.hasOwnProperty("file_is_shared")&&void 0!==e.file_is_shared&&(this.file_is_shared=e.file_is_shared),e.hasOwnProperty("file_last_edited")&&void 0!==e.file_last_edited&&(this.file_last_edited=e.file_last_edited),e.hasOwnProperty("file_name")&&void 0!==e.file_name&&(this.file_name=e.file_name),e.hasOwnProperty("file_nsid")&&void 0!==e.file_nsid&&(this.file_nsid=e.file_nsid),e.hasOwnProperty("file_path")&&void 0!==e.file_path&&(this.file_path=e.file_path),e.hasOwnProperty("file_size")&&void 0!==e.file_size&&(this.file_size=e.file_size),e.hasOwnProperty("file_sjid")&&void 0!==e.file_sjid&&(this.file_sjid=e.file_sjid),e.hasOwnProperty("file_type_filters")&&void 0!==e.file_type_filters&&(this.file_type_filters=e.file_type_filters),e.hasOwnProperty("identity_gid")&&void 0!==e.identity_gid&&(this.identity_gid=e.identity_gid),e.hasOwnProperty("latency")&&void 0!==e.latency&&(this.latency=null!==e.latency?e.latency.toString():null),e.hasOwnProperty("locale_browser_header")&&void 0!==e.locale_browser_header&&(this.locale_browser_header=e.locale_browser_header),e.hasOwnProperty("locale_user_selected")&&void 0!==e.locale_user_selected&&(this.locale_user_selected=e.locale_user_selected),e.hasOwnProperty("match_type")&&void 0!==e.match_type&&(this.match_type=e.match_type),e.hasOwnProperty("paper_folder_id")&&void 0!==e.paper_folder_id&&(this.paper_folder_id=e.paper_folder_id),e.hasOwnProperty("paper_pad_id")&&void 0!==e.paper_pad_id&&(this.paper_pad_id=e.paper_pad_id),e.hasOwnProperty("path_scoped")&&void 0!==e.path_scoped&&(this.path_scoped=null!==e.path_scoped?e.path_scoped.toString():null),e.hasOwnProperty("position")&&void 0!==e.position&&(this.position=null===e.position?null:e.position.toString()),e.hasOwnProperty("preview_request_id")&&void 0!==e.preview_request_id&&(this.preview_request_id=e.preview_request_id),e.hasOwnProperty("query_string")&&void 0!==e.query_string&&(this.query_string=e.query_string),e.hasOwnProperty("query_suggestion_count")&&void 0!==e.query_suggestion_count&&(this.query_suggestion_count=e.query_suggestion_count),e.hasOwnProperty("query_suggestion_strings")&&void 0!==e.query_suggestion_strings&&(this.query_suggestion_strings=e.query_suggestion_strings),e.hasOwnProperty("recent_history_map")&&void 0!==e.recent_history_map&&(this.recent_history_map=e.recent_history_map),e.hasOwnProperty("referrer")&&void 0!==e.referrer&&(this.referrer=e.referrer),e.hasOwnProperty("request_id")&&void 0!==e.request_id&&(this.request_id=e.request_id),e.hasOwnProperty("result_count")&&void 0!==e.result_count&&(this.result_count=null!==e.result_count?e.result_count.toString():null),e.hasOwnProperty("result_id")&&void 0!==e.result_id&&(this.result_id=e.result_id),e.hasOwnProperty("session_id")&&void 0!==e.session_id&&(this.session_id=e.session_id),e.hasOwnProperty("source")&&void 0!==e.source&&(this.source=e.source),e.hasOwnProperty("start")&&void 0!==e.start&&(this.start=null!==e.start?e.start.toString():null),e.hasOwnProperty("team_id")&&void 0!==e.team_id&&(this.team_id=e.team_id),e.hasOwnProperty("team_type")&&void 0!==e.team_type&&(this.team_type=e.team_type),e.hasOwnProperty("timestamp")&&void 0!==e.timestamp&&(this.timestamp=e.timestamp),e.hasOwnProperty("timezone_offset")&&void 0!==e.timezone_offset&&(this.timezone_offset=e.timezone_offset),e.hasOwnProperty("type")&&void 0!==e.type&&(this.type=e.type),e.hasOwnProperty("typeahead_session_id")&&void 0!==e.typeahead_session_id&&(this.typeahead_session_id=e.typeahead_session_id),e.hasOwnProperty("ua_browser_name")&&void 0!==e.ua_browser_name&&(this.ua_browser_name=e.ua_browser_name),e.hasOwnProperty("ua_browser_version")&&void 0!==e.ua_browser_version&&(this.ua_browser_version=e.ua_browser_version),e.hasOwnProperty("ua_dist_name")&&void 0!==e.ua_dist_name&&(this.ua_dist_name=e.ua_dist_name),e.hasOwnProperty("ua_dist_version")&&void 0!==e.ua_dist_version&&(this.ua_dist_version=e.ua_dist_version),e.hasOwnProperty("ua_os_name")&&void 0!==e.ua_os_name&&(this.ua_os_name=e.ua_os_name),e.hasOwnProperty("ua_os_version")&&void 0!==e.ua_os_version&&(this.ua_os_version=e.ua_os_version),e.hasOwnProperty("user_agent")&&void 0!==e.user_agent&&(this.user_agent=e.user_agent),e.hasOwnProperty("user_id")&&void 0!==e.user_id&&(this.user_id=e.user_id),e.hasOwnProperty("view_type")&&void 0!==e.view_type&&(this.view_type=e.view_type),e.hasOwnProperty("viewport")&&void 0!==e.viewport&&(this.viewport=e.viewport),e.hasOwnProperty("search_scoped_to_account_id")&&void 0!==e.search_scoped_to_account_id&&(this.search_scoped_to_account_id=e.search_scoped_to_account_id),e.hasOwnProperty("action_source")&&void 0!==e.action_source&&(this.action_source=e.action_source),Object.seal(this)};t.SearchWebSearchActivityRow=r})),define("modules/clean/react/starred/browse_exports",["require","exports","modules/clean/react/home/resource_id_types","modules/clean/react/starred/actions","modules/clean/react/starred/browse_update","modules/clean/react/starred/constants","modules/clean/react/starred/id_type_pair","modules/clean/react/starred/star","modules/clean/react/starred/store"],(function(e,t,r,n,s,i,a,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HOME_RESOURCE_ID_TYPE=r.HOME_RESOURCE_ID_TYPE,t.StarredActions=n.StarredActions,t.checkForMissingStarredData=s.checkForMissingStarredData,t.StarredSource=i.StarredSource,t.idTypePairFromStarrableItem=a.idTypePairFromStarrableItem,t.Star=o.Star,t.StarredStore=l.StarredStore})),define("modules/clean/react/starred/browse_update",["require","exports","modules/clean/react/starred/actions","modules/clean/react/starred/id_type_pair","modules/clean/react/starred/store"],(function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkForMissingStarredData=function(e){var t=e.items,i=e.isNonUserRelativeContext,a=e.user;if(!i){var o=t.map(n.idTypePairFromStarrableItem).filter((function(e){return!(!e.id||s.StarredStore.hasIdTypePair(e))}));o.length&&r.StarredActions.fetchStatuses(a.role,o)}}})),define("modules/clean/search/search_bar/query_suggestions_table",["require","exports","tslib","classnames","react","spectrum/icon_global","modules/clean/keycode","modules/core/i18n"],(function(e,t,r,n,s,i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.querySuggestions,r=e.indexOffset,n=e.highlightedRow,i=e.onQuerySuggestionsClick,a=e.onHighlightDropdownItem,l=e.showHeader,u=o._("Suggested searches");return s.default.createElement("div",{className:"search__query-suggestions"},l&&s.default.createElement("div",{className:"search__query-suggestion-header"},u),t.map((function(e,t){return s.default.createElement(c,{key:"query-suggestion-"+t,querySuggestion:e,index:t,indexOffset:r,isHighlighted:void 0!==n&&t===n-r,onQuerySuggestionsClick:i,onHighlightDropdownItem:a,showHeader:l})})))},t})((s=r.__importDefault(s)).default.PureComponent);t.QuerySuggestionsTable=l;var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){t.props.onQuerySuggestionsClick(t.props.querySuggestion,t.props.index)},t.handleKeyPress=function(e){switch(e.which){case a.KeyCode.ENTER:case a.KeyCode.SPACE:t.props.onQuerySuggestionsClick(t.props.querySuggestion,t.props.index),e.preventDefault()}},t.handleHighlight=function(){var e=t.props.onHighlightDropdownItem;e&&e(t.props.index+t.props.indexOffset)},t.getAriaLabel=function(){return o._("Search for %(query)s").format({query:t.props.querySuggestion.text})},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.isHighlighted,r=e.showHeader,a=e.querySuggestion,o=e.index,l=n.default({"search__query-suggestion-item":!0,"search__query-suggestion-item-highlighted":t,"search__query-suggestion-item-reduced-height":!r});return s.default.createElement("li",{className:l,role:"option","aria-label":this.getAriaLabel(),"aria-selected":t,onClick:this.handleClick,onMouseEnter:this.handleHighlight,onKeyPress:this.handleKeyPress},s.default.createElement("div",{className:"mc-media-cell-icon search__query-suggestion-icon"},s.default.createElement(i.IconGlobal,{name:"search-small"})),s.default.createElement("div",{className:"mc-media-cell-text search__query-suggestion-text"},s.default.createElement(u,{querySuggestion:a,showHeader:r,keyName:"query-suggestion-"+o})))},t})(s.default.PureComponent);t.QuerySuggestionRow=c;var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.showHeader,r=e.querySuggestion,n=e.keyName;return!t&&r.highlight_spans&&r.highlight_spans.length?r.highlight_spans.filter((function(e){return void 0!==e.highlight_str&&void 0!==e.is_highlighted})).map((function(e,t){return e.is_highlighted?s.default.createElement("span",{key:n+"-"+t},e.highlight_str):s.default.createElement("b",{key:n+"-"+t},e.highlight_str)})):r.text},t})(s.default.PureComponent);t.QuerySuggestionRowText=u})),define("modules/clean/search/search_results/sidebar_view",["require","exports","tslib","react","react-redux","modules/clean/react/app_actions_view","modules/clean/react/browse/models","modules/clean/react/browse/selection_preview_pane","modules/clean/react/browse/util","modules/clean/react/extensions/data/selectors","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/types","modules/clean/react/folder_overview/sidebar_controller","modules/clean/react/folder_overview/utils","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/data/selectors/index","modules/clean/web_timing_logger","modules/core/exception","modules/core/i18n"],(function(e,t,r,n,s,i,a,o,l,c,u,d,p,_,h,g,f,m,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),c=r.__importStar(c),u=r.__importStar(u),h=r.__importStar(h),g=r.__importStar(g);var y=(function(t){function s(e){var r=t.call(this,e)||this;return r.state={},r}return r.__extends(s,t),s.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(n){switch(n.label){case 0:return[4,f.waitForTTI()];case 1:return n.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/browse/file_actions/file_actions"],t,r)})).then(r.__importStar)];case 2:return t=n.sent(),this.setState({fileActionsModule:t}),[2]}}))}))},s.prototype.render=function(){var e=this.props,t=e.context,r=e.selectedFiles,s=e.user,c=e.actionHandlers,u=e.searchBarExperiments,h=e.viewType,g=e.responsive,f=e.extensionsFeatureFlags,y=e.sharingServiceInfo,v=e.onContextMenuClick,E=e.shouldShowSelectionPreviewPane,w=e.shouldShowFolderOverview,T=e.scrollableSidebarRef,C=e.isFolderOverviewEnabled,F=u.expSearchSuccessBanner;if(!s||!r.size)return null;var R=[];if(this.state.fileActionsModule&&(R=this.state.fileActionsModule.getActionsForFileCollection({files:r,context:t,user:s,viewType:h,extensionsFeatureFlags:f,sharingServiceInfo:y,actionHandlers:c,isSearchMode:!0,responsive:g,useSearchSuccessBanner:!!F,isSidebar:!0,scrollableSidebarRef:T})),R.length){m.assert("function"!=typeof R[0],"The first primary menu item for AppActionsView must be a BrowseAppActionLink");var A=R[0],I=[{displayName:A.label,handleClick:A.performAction,iconName:A.iconName,className:A.className,disabled:A.disabled}],b=[];R.slice(1).forEach((function(e,t){"function"==typeof e?I.push(e):b.push({displayName:e.label,handleClick:e.performAction,iconName:e.iconName,className:e.className,disabled:e.disabled,key:e.key})}));var P=l.getSelectedFilesText(r,t),L=r&&0!==r.size;return n.default.createElement(n.default.Fragment,null,E&&n.default.createElement(o.SelectionPreviewPane,{selectedFiles:r}),n.default.createElement(i.AppActionsView,{headerText:P,popoverTriggerLabel:S._("Actions"),primaryMenuItems:I,secondaryMenuItems:b,responsive:g,hideHeaderText:!!E,shouldCollapseActions:L,onContextMenuClick:v,isPrimaryActionSapphire:!0,scrollableSidebarRef:T,shouldUsePortalPopover:!0}),w&&n.default.createElement(p.SidebarFolderOverview,{path:r.first().fq_path,nsId:r.first().target_ns?"ns:"+r.first().target_ns+"/":"ns:"+r.first().ns_id+"/"+r.first().ns_path,browseLoadingState:d.LoadingState.LOADED,componentNamespace:"search-sidebar",isReadOnly:!_.canEditOverviewForFile(r.first()),onlyRenderExistingFolderOverviews:!C,canShareFolder:!a.File.isNoAccessSharedFolder(r.first())}))}return E&&n.default.createElement(o.SelectionPreviewPane,{selectedFiles:r})},s})(n.default.PureComponent);t.SearchResultsSidebarViewComponent=y,t.SearchResultsSidebarView=s.connect((function(e,t){return{user:g.user(e),selectedFiles:g.selectedFiles(e),searchBarExperiments:h.searchBarExperiments(e),context:g.context(e),viewType:u.viewType(e),extensionsFeatureFlags:c.getFeatureFlags(e),sharingServiceInfo:c.sharingServiceInfo(e),shouldShowSelectionPreviewPane:h.shouldShowSelectionPreviewPane(e,t),shouldShowFolderOverview:h.shouldShowFolderOverview(e,t),isFolderOverviewEnabled:h.isFolderOverviewEnabled(e)}}))(y)})),define("modules/clean/search/search_results/view",["require","exports","tslib","external/lodash","immutable","react","spectrum/media_table","spectrum/table","spectrum/tip_card","modules/clean/filepath","modules/clean/history","modules/clean/react/async/loadable","modules/clean/react/browse/models","modules/clean/react/files_view/column_helpers","modules/clean/react/files_view/constants","modules/clean/react/files_view/controller","modules/clean/react/files_view/types","modules/clean/react/image","modules/clean/search/constants","modules/clean/search/search_helpers","modules/clean/static_urls","modules/core/i18n"],(function(e,t,r,n,s,i,a,o,l,c,u,d,p,_,h,g,f,m,S,y,v,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),s=r.__importStar(s),i=r.__importDefault(i),c=r.__importStar(c),u=r.__importDefault(u),S=r.__importStar(S),y=r.__importStar(y);var w=d.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/retrieval_success_banner/search_feedback_banner"],t,r)})).then(r.__importStar).then((function(e){return e.SearchFeedbackBanner}))}}),T=d.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/retrieval_success_banner/search_satisfaction_banner"],t,r)})).then(r.__importStar).then((function(e){return e.SearchSatisfactionBanner}))}}),C=(function(e){function t(t){var n=e.call(this,t)||this;return n._handleScroll=function(){n.props.onScroll()},n._ensureFileViewerClosedIfNotPreviewing=function(){var e=u.default.deconstruct_url().qargs;n.props.ensureFileViewerClosedIfNotPreviewing(e)},n._handleRemoveAllFilters=function(e){e.preventDefault(),n.props.onSearchFiltersChanged({path:"/",fileCategories:r.__assign({},S.FILE_CATEGORIES_UNCHECKED)})},n._getRemoveAllFiltersViewUrl=function(){var e=n.props,t=e.user,r=e.latestQuery,s=e.searchSessionId;return y.buildSearchURL({user:t,searchPath:"/",normalizedQuery:r,searchSessionId:s,searchToken:y.getSearchCsrfToken(),qargs:{file_categories:void 0}}).toString()},n._renderEmptyFolderSubtitle=function(){var e=n.props,t=e.path,r=e.fileCategories;return c.paths_are_equal(t,"/")&&!y.fileCategoriesSet(r)?E._("Try different keywords"):E.intl.formatMessage(E._("Try <LinkScope>resetting all filters</LinkScope>"),{LinkScope:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.default.createElement("a",{href:n._getRemoveAllFiltersViewUrl(),onClick:n._handleRemoveAllFilters},e)}})},n._renderEmptyFolderView=function(e){var t=E._("No results found");return i.default.createElement("div",null,i.default.createElement("div",{className:"u-font-center u-pad-top-xl"},i.default.createElement(m.Image,{src:v.static_url("/static/images/empty_states/search-vflHMNVT9.png"),srcHiRes:v.static_url("/static/images/empty_states/search@2x-vfly2B3kk.png"),alt:""}),i.default.createElement("h2",{className:"u-font-strong empty-folder-table-title"},t),i.default.createElement("span",null,n._renderEmptyFolderSubtitle())))},n._shouldShowSearchFeedbackBanner=function(){return n._getLoadingState()!==f.LoadingState.LOADING_FIRST_PAGE&&n.props.searchResultsExperiments.expImageFeedbackBanner&&n.props.searchType===S.SearchType.IMAGE},n._renderSearchFeedbackBanner=function(){return n._shouldShowSearchFeedbackBanner()?n.props.searchResultsExperiments.expSatisfactionBanner?n.props.responsive.isMatchedMedium&&i.default.createElement(T,null):i.default.createElement(w,null):null},n.state={viewTypeColumns:n._generateViewTypeColumns(),searchResultsWithUserDefinedItem:n._generateSearchResultsWithUserDefinedItem(t.searchResults)},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){window.addEventListener("scroll",this._handleScroll)},t.prototype.componentWillReceiveProps=function(e){var t=this.props,r=t.currentSort,n=t.searchResults,s=e.viewType,i=e.currentSort,a=e.searchResults,o=this.state.viewTypeColumns;r&&i&&o&&!y.areSortOrdersEqual(r,i)&&this.setState({viewTypeColumns:this._updateViewTypeColumns(o,s,i)}),n!==a&&this.setState({searchResultsWithUserDefinedItem:this._generateSearchResultsWithUserDefinedItem(a)})},t.prototype.componentWillUnmount=function(){window.removeEventListener("scroll",this._handleScroll),u.default.remove_callback("/search",this._ensureFileViewerClosedIfNotPreviewing)},t.prototype._getLoadingState=function(){var e=this.props.loadingState;return e===S.SearchLoadingState.LOADING_FIRST_PAGE?f.LoadingState.LOADING_FIRST_PAGE:e===S.SearchLoadingState.LOADING_ADDITIONAL_PAGE?f.LoadingState.LOADING_REMAINING_PAGES:f.LoadingState.LOADED},t.prototype._renderSearchResultItems=function(e){var t=this.props,s=t.getOverflowMenuActions,a=t.onFocusSearchBar,o=t.onLocationLinkClick,l=t.onNavigateToFileOrFolder,c=t.onNavigateToParentFolder,u=t.onOpenFileSharedWithMe,d=t.onOpenPaper,p=t.context,_=t.fileRename,m=t.searchResults,S=t.getIsFileJumping,y=t.isFileViewerShown,v=t.arePostTTIModulesLoaded,E=t.handleComponentTTI,w=t.onSelectionChange,T=t.selectedFiles,C=t.selection,F=t.setFileUploaderPath,R=t.viewType,A=t.user,I=t.path,b=t.filesViewActionHandlers,P=t.renderSharedWithController,L=t.hrefForFile,x=t.starredState,O=t.pageHeaderHeight,D=t.onStarClick,N=t.extensionsFeatureFlags,q=t.sharingServiceInfo,Q=t.currentSort,M=t.onSortChange,H=t.onRangeInView,k=t.scrollContainer,U=t.filteredContactName,W=this.props.searchBarExperiments.expSearchSuccessBanner,V=this.state.viewTypeColumns,G=this.props.searchResultsExperiments.expSnippets;return i.default.createElement(g.FilesViewController,r.__assign({},b,{getOverflowMenuActions:s,onLocationLinkClick:o,onNavigateToFileOrFolder:l,onNavigateToParentFolder:c,onOpenFileSharedWithMe:u,onOpenPaper:d,context:p,customEmptyFolderView:this._renderEmptyFolderView,createNewFolderState:f.NewFolderCreationState.CREATE_FOLDER_INACTIVE,fileRename:_,getIsFileJumping:S,isFileViewerShown:y,isSearchMode:!0,arePostTTIModulesLoaded:v,loadingState:this._getLoadingState(),onComponentTTI:E,onSelectionChange:w,onFocusSearchBar:a,path:I,selectedFiles:T,selection:C,setFileUploaderPath:F,showFileUploaderModal:n.noop,user:A,viewType:R,totalNumFiles:m.size,responsive:e,columns:this._generateColumns(e),renderSharedWithController:P,hrefForFile:L,viewTypes:h.AllViewTypes,viewTypeLabels:h.ViewTypeLabels,starredState:x,stickyOffsetTop:O,extensionsFeatureFlags:N,sharingServiceInfo:q,onStarClick:D,useSearchSuccessBanner:!!W,items:this._generateFilesViewItems(),isStickyColumnHeader:!0,viewTypeColumns:V,onColumnsChanged:n.noop,currentSort:Q,onSortChange:M,expSnippets:G,highDensity:!0,onRangeInView:H,scrollContainer:k,filteredContactName:U}))},t.prototype._generateColumns=function(e){var t=this.props.viewType,r=this.state.viewTypeColumns;return r?r[t]:h.SEARCH_LIST_VIEW_COLUMNS},t.prototype._generateViewTypeColumns=function(){var e,t=this.props,r=t.viewType,n=t.currentSort,s=((e={})[f.ViewType.List]=h.SEARCH_LIST_VIEW_SORT_ENABLED_COLUMNS,e[f.ViewType.Grid]=h.SEARCH_GRID_VIEW_SORT_ENABLED_COLUMNS,e[f.ViewType.LargeGrid]=h.SEARCH_GRID_VIEW_SORT_ENABLED_COLUMNS,e);return n?this._updateViewTypeColumns(s,r,n):s},t.prototype._isDeletedFile=function(e){return e instanceof p.File&&e.isDeleted},t.prototype._generateSearchResultsWithUserDefinedItem=function(e){var t=this,r=e.filter((function(e){return t._isDeletedFile(e)}));if(r.size>0){var n=e.filter((function(e){return!t._isDeletedFile(e)})),c=new p.UserDefinedItem({renderUserDefinedItemRow:function(e){var t=e.rowIndex,r=e.topOffset;return i.default.createElement(a.CulledMediaRow,{"aria-rowindex":void 0!==t?t+1:void 0,className:"brws-user-defined-item-row",topOffset:r},i.default.createElement(o.TableCell,{key:"checkboxCell",className:"brws-checkbox-cell"}),i.default.createElement(o.TableCell,{className:"mc-media-cell"},i.default.createElement(l.TipCard,{className:"search-results__deleted-files-notice","non-dismissible":!0},E._("Deleted content isnâ€™t sorted by last modified"))))}});return n.concat([c]).concat(r)}return s.List()},t.prototype._generateFilesViewItems=function(){var e=this,t=this.props,r=t.searchResults,n=t.viewType,s=t.currentSort,i=r.filter((function(t){return e._isDeletedFile(t)}));return n===f.ViewType.List&&s&&s.sortField!==f.SortField.RELEVANCE&&i.size>0?this.state.searchResultsWithUserDefinedItem:r},t.prototype._updateViewTypeColumns=function(e,t,n){var s,i,a=e[t];if(t===f.ViewType.List)return r.__assign(r.__assign({},e),((s={})[t]=_.swapColumns(a,a[1].sortField,n.sortField),s));var o=e[f.ViewType.List];return r.__assign(r.__assign({},e),((i={})[t]=_.swapColumns(a,a[0].sortField,n.sortField),i[f.ViewType.List]=_.swapColumns(o,o[1].sortField,n.sortField),i))},t.prototype.render=function(){var e=this.props.responsive;return i.default.createElement("div",{className:"search-results"},this._renderSearchFeedbackBanner(),this._renderSearchResultItems(e))},t})(i.default.Component);t.SearchResultsView=C})),define("modules/clean/search/single_page/api",["require","exports","modules/clean/contacts/data_v2"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){var t=this;this.filterContact=function(e){return!e.group_id&&!!e.dbx_account_id},this.fetchContacts=function(e){return new Promise((function(r,n){""===e?t.dataSource.getAll(r):t.dataSource.search(e,r)}))},this.dataSource=new r.ContactsDataSourceV2(e,this.filterContact)},s=null;t.getContactApiClient=function(e){return s||(s=new n(e)),s}})),define("modules/clean/search/single_page/data/action_creators",["require","exports","tslib","immutable","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/data/selectors","modules/clean/react/browse/logger_util","modules/clean/react/browse/models","modules/clean/react/extensions/data/store","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/files_view/file_actions/file_from_metadata","modules/clean/react/files_view/file_actions/rollback","modules/clean/react/files_view/file_actions/snackbars","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/selection","modules/clean/react/snackbar","modules/clean/react/starred/browse_update","modules/clean/search/api","modules/clean/search/constants","modules/clean/search/search_bar/api","modules/clean/search/search_helpers","modules/clean/search/single_page/api","modules/clean/search/single_page/constants","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/data/types","modules/clean/search/single_page/logger","modules/clean/search/single_page/navigation","modules/clean/search/single_page/utils","modules/clean/search/store_helpers","modules/clean/search/types","modules/clean/storage","modules/clean/undo","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/core/exception","modules/core/i18n"],(function(e,t,r,n,s,i,a,o,l,c,u,d,p,_,h,g,f,m,S,y,v,E,w,T,C,F,R,A,I,b,P,L,x,O,D,N,q,Q,M,H,k,U,W,V,G){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),s=r.__importStar(s),i=r.__importStar(i),a=r.__importStar(a),l=r.__importStar(l),u=r.__importStar(u),d=r.__importStar(d),h=r.__importStar(h),g=r.__importStar(g),f=r.__importStar(f),y=r.__importStar(y),L=r.__importStar(L),x=r.__importStar(x),D=r.__importStar(D),Q=r.__importStar(Q);var B=null,z=null;t.clear=function(){return function(e,t){var r="/";try{r=u.path(t())}catch(e){}null!==B&&clearTimeout(B),e({type:O.ActionTypes.SET_QUERY,payload:{query:""}}),e({type:O.ActionTypes.CLEAR_RESULTS}),e({type:O.ActionTypes.SET_PATH,payload:{path:r}}),e({type:O.ActionTypes.SET_FILE_CATEGORIES,payload:{fileCategories:R.FILE_CATEGORIES_UNCHECKED}}),e(Z({loadingState:R.SearchLoadingState.ZERO_QUERY})),e({type:O.ActionTypes.SET_FILTERED_ACCOUNT_ID,payload:{filteredAccountId:void 0}})}},t.setVariant=function(e){var t=e.variant;return{type:O.ActionTypes.SET_VARIANT,payload:{variant:t}}},t.setUser=function(e){var t=e.user,r=e.options;return{type:O.ActionTypes.SET_USER,payload:{user:t,options:r}}},t.setExperiments=function(e){var t=e.experiments;return{type:O.ActionTypes.SET_EXPERIMENTS,payload:{experiments:t}}},t.setQuery=function(e){var r=e.query,n=e.alwaysTriggerSearch;return function(e,s){var i=Q.normalize(r),a=i!==x.normalizedQuery(s()),o=""===x.normalizedQuery(s())&&a,l=t.shouldStartNewSearchSession(s(),{query:r}),c=L.isSearchAsYouTypeEnabled(s())||n,u=x.user(s());if(u&&(e({type:O.ActionTypes.SET_QUERY,payload:{query:r}}),D.logQueryTyped(r),a)){if(e(t.resetTTI()),""===i&&(e(t.setLastQueryWithQuerySuggestionsLoaded({lastQueryWithQuerySuggestionsLoaded:i})),e(re({lastQueryWithPeopleSuggestionsLoaded:i}))),l&&e(t.setSessionId({sessionId:q.generateRandomId()})),c&&(o||l)&&e(Z({loadingState:R.SearchLoadingState.LOADING_FIRST_PAGE})),se(),c&&x.isFullPage(s())&&N.searchNavigationManager.set(x.searchUrl(s())),""===i&&!x.filteredAccountId(s())&&c)return e(j()),void e(Z({loadingState:R.SearchLoadingState.ZERO_QUERY}));i&&e(t.fetchQuerySuggestions({query:i,maxResults:P.SEARCH_POSTERIOR_QUERY_SUGGESTIONS_CAPACITY})),L.isInPeopleFilterExperiment(s())&&!x.filteredAccountId(s())&&i&&e(t.fetchPeopleSuggestions({query:i,user:u})),c&&(B=setTimeout((function(){e($({loadingDeletedResults:!1})),t.fetchFirstPage(e,s),B=null}),P.SEARCH_QUERY_DEBOUNCE))}}},t.setPath=function(e){var r=e.path,n=e.viewport;return function(e,s){i.paths_are_equal(r,x.path(s()))||(e({type:O.ActionTypes.SET_PATH,payload:{path:r}}),n&&D.logScopeChipChanged(r,n),t._performSearch(e,s))}},t.setFileCategories=function(e){var r=e.fileCategories;return function(e,n){I.fileCategoriesToString(r)!==x.fileCategoriesString(n())&&(e({type:O.ActionTypes.SET_FILE_CATEGORIES,payload:{fileCategories:r}}),x.isFullPage(n())&&N.searchNavigationManager.set(x.searchUrl(n()),!0),e(Z({loadingState:R.SearchLoadingState.LOADING_FIRST_PAGE})),t._performSearch(e,n))}},t.setSearchType=function(e){var r=e.searchType;return function(e,n){r!==x.searchType(n())&&(e(t.stopAndLogDwellTime()),e({type:O.ActionTypes.SET_SEARCH_TYPE,payload:{searchType:r}}),t._performSearch(e,n))}},t.setSortOrder=function(e){var r=e.sortOrder;return function(e,n){ce(r,x.sortOrder(n()))||(e({type:O.ActionTypes.SET_SORT_ORDER,payload:{sortOrder:r}}),D.logSortOrderChanged(r),x.isFullPage(n())&&N.searchNavigationManager.set(x.searchUrl(n()),!0),e(Z({loadingState:R.SearchLoadingState.LOADING_FIRST_PAGE})),t._performSearch(e,n))}},t.setFilteredAccountId=function(e){var r=e.filteredAccountId;return function(e,n){if(r!==x.filteredAccountId(n())){if(r||D.logPeopleFilterRemoved(),e({type:O.ActionTypes.SET_FILTERED_ACCOUNT_ID,payload:{filteredAccountId:r}}),x.isFullPage(n())&&N.searchNavigationManager.set(x.searchUrl(n())),!r&&!x.normalizedQuery(n()))return e(j()),void e(Z({loadingState:R.SearchLoadingState.ZERO_QUERY}));t._performSearch(e,n)}}},t.fetchPeopleSuggestions=function(e){var t=e.user,n=e.query;return function(e,s){return r.__awaiter(this,void 0,void 0,(function(){var i,a,o,l;return r.__generator(this,(function(r){switch(r.label){case 0:if(i=Q.normalize(n),a=x.peopleSuggestionsCache(s())[i]){if((o=a.loadingState)===M.PeopleSuggestionsLoadingState.LOADING)return[2];if(o===M.PeopleSuggestionsLoadingState.LOADED)return e(re({lastQueryWithPeopleSuggestionsLoaded:i})),[2];if(o===M.PeopleSuggestionsLoadingState.DISMISSED)return e(te({normalizedQuery:i,peopleSuggestionsData:{loadingState:M.PeopleSuggestionsLoadingState.LOADED}})),e(re({lastQueryWithPeopleSuggestionsLoaded:i})),[2]}return e(te({normalizedQuery:i,peopleSuggestionsData:{contacts:[],loadingState:M.PeopleSuggestionsLoadingState.LOADING}})),[4,b.getContactApiClient(t).fetchContacts(i)];case 1:return l=r.sent(),D.logPeopleFilterResponse(l.length),e(te({normalizedQuery:i,peopleSuggestionsData:{contacts:l,loadingState:M.PeopleSuggestionsLoadingState.LOADED}})),e(re({lastQueryWithPeopleSuggestionsLoaded:i})),[2]}}))}))}},t.dismissPeopleSuggestions=function(e){var t=e.query;return function(e,r){var n=Q.normalize(t),s=x.peopleSuggestionsCache(r())[n];s&&s.loadingState===M.PeopleSuggestionsLoadingState.LOADED&&e(te({normalizedQuery:n,peopleSuggestionsData:{loadingState:M.PeopleSuggestionsLoadingState.DISMISSED}}))}},t.updateFromUrl=function(e){var r=e.path,n=e.query,s=e.search_session_id,i=e.preview,a=e.file_categories,o=e.search_type,l=e.search_order_by,c=e.search_reverse_order,u=e.search_account_id,d=e.search_from;return function(e,p){var _=!1,h=n||"",g=a||"";h!==x.query(p())&&(_=!0,e({type:O.ActionTypes.SET_QUERY,payload:{query:h}})),void 0!==r&&r!==x.path(p())&&(_=!0,e({type:O.ActionTypes.SET_PATH,payload:{path:r}})),g!==x.fileCategoriesString(p())&&(_=!0,e({type:O.ActionTypes.SET_FILE_CATEGORIES,payload:{fileCategories:I.fileCategoriesFromString(g)}})),void 0!==o&&o!==x.searchType(p())&&(_=!0,e({type:O.ActionTypes.SET_SEARCH_TYPE,payload:{searchType:o}}));var f=oe(d),m={sortField:ae(l),sortDirection:le(c)};if(ce(m,x.sortOrder(p()))||(e({type:O.ActionTypes.SET_SORT_ORDER,payload:{sortOrder:m}}),D.logSortOrderChanged(m),_=!0),u!==x.filteredAccountId(p())){_=!0,e({type:O.ActionTypes.SET_FILTERED_ACCOUNT_ID,payload:{filteredAccountId:u}});var S=x.user(p());S&&e(t.fetchPeopleSuggestions({query:"",user:S}))}void 0!==s&&s!==x.sessionId(p())&&(_=!0,e(t.setSessionId({sessionId:s}))),i!==x.previewFileId(p())&&e({type:O.ActionTypes.SET_PREVIEW_FILE_ID,payload:{previewFileId:""===i?void 0:i}}),_&&(""!==x.normalizedQuery(p())||x.filteredAccountId(p())?e((function(e,r){return t._performSearch(e,r,f)})):(e(j()),e(Z({loadingState:R.SearchLoadingState.ZERO_QUERY}))))}},t.fetchNextPage=function(){return function(e,n){var s=x.user(n()),i=x.path(n()),a=x.normalizedQuery(n()),o=x.loadingDeletedResults(n()),l=x.hasMoreResults(n()),c=x.cursor(n()),u=x.searchType(n()),d=x.fileCategoriesString(n()),p=x.filteredAccountId(n()),h=ne(n());s&&(a||p)&&l&&(o&&(d.length||p)||(x.results(n()).size>0&&e(Z({loadingState:R.SearchLoadingState.LOADING_ADDITIONAL_PAGE})),F.searchApiClient.loadPartialResults(r.__assign(r.__assign({},h),{deleted:o,start:x.nextPageOffset(n())||0,cursor:c,onSuccess:function(r){var l=r.searchResults;t.hasSearchChanged(n(),{query:a,path:i,filteredAccountId:p,searchType:u,fileCategoriesString:d})||(e(K({searchResults:l,loadingState:R.SearchLoadingState.LOADED})),o||(e(t.logQueryCompleted()),l.hasMore||u!==R.SearchType.ALL||0!==x.fileCategoriesArray(n()).length||(e($({loadingDeletedResults:!0})),e(t.fetchNextPage())),l.results.length&&_.initializeStore(s,l.results.filter(ue)),C.checkForMissingStarredData({items:l.results,user:s}),l.hasMore&&l.results.length<h.maxResults&&e(t.fetchNextPage())))},onError:function(e){V.reportException({err:new Error(e),severity:"non-critical",tags:["js:search"]})}}))))}},t.setSelection=function(e){var t=e.selection,r=e.actionSource,n=e.skipLogging;return function(e,s){if(!n){var i=s(),a=d.makeSelectionEvent(x.selection(i),t),o=a.event,l=a.itemId,c=x.selectResultById(i,{id:l});if(c){var u=d.countFilesAndFolders(x.selectFilesForSelection(i,{selection:t})),p=u.num_files_selected,_=u.num_folders_selected;D.logResultAction(o,x.resultsList(i),c,void 0,r,{num_files_selected:String(p),num_folders_selected:String(_)})}}e({type:O.ActionTypes.SET_SELECTION,payload:{selection:t,actionSource:r,skipLogging:n}})}},t.clearSelection=function(e){var r=void 0===e?{}:e,n=r.actionSource,s=r.skipLogging;return t.setSelection({actionSource:n,skipLogging:s,selection:w.createSelection()})},t.setPreviewFile=function(e){var r=e.previewFileId;return function(e,n){e(void 0===r?t.startDwellTime():t.stopAndLogDwellTime()),e({type:O.ActionTypes.SET_PREVIEW_FILE_ID,payload:{previewFileId:r}}),x.isFullPage(n())&&N.searchNavigationManager.set(x.searchUrl(n()),!0)}},t.setSessionId=function(e){var t=e.sessionId;return{type:O.ActionTypes.SET_SESSION_ID,payload:{sessionId:t}}},t.performSearch=function(){return function(e,r){""!==x.normalizedQuery(r())||x.filteredAccountId(r())?(x.isFullPage(r())&&N.searchNavigationManager.set(x.searchUrl(r())),t._performSearch(e,r)):(e(j()),e(Z({loadingState:R.SearchLoadingState.ZERO_QUERY})),x.isFullPage(r())&&N.searchNavigationManager.set(x.searchUrl(r())))}},t._performSearch=function(e,r,n){void 0===n&&(n=R.SearchOriginPathway.WEB),(""!==x.normalizedQuery(r())||x.filteredAccountId(r()))&&(e(t.resetTTI()),x.isFullPage(r())&&N.searchNavigationManager.set(x.searchUrl(r())),e(Z({loadingState:R.SearchLoadingState.LOADING_FIRST_PAGE})),e($({loadingDeletedResults:!1})),null!==B&&clearTimeout(B),t.fetchFirstPage(e,r,n))},t.fetchFirstPage=function(e,n,s){void 0===s&&(s=R.SearchOriginPathway.WEB);var i=x.user(n()),a=x.path(n()),o=x.normalizedQuery(n()),l=x.loadingDeletedResults(n()),c=x.searchType(n()),u=x.variant(n()),d=x.fileCategoriesString(n()),p=x.filteredAccountId(n());if(i&&(o||p)){var g=L.artificalLatency(n());l||(e(t.stopAndLogDwellTime()),e(t.setQueryStartTime({queryStartTime:(new Date).getTime()})),D.logQueryStarted(s)),se(),F.searchApiClient.loadPartialResults(r.__assign(r.__assign({},ne(n())),{start:0,includeBrowseContext:"full-page"===u,artificialLatency:g,onSuccess:function(r){var s=r.searchResults,g=r.requestId,f=r.context;if(!t.hasSearchChanged(n(),{query:o,path:a,filteredAccountId:p,searchType:c,fileCategoriesString:d})){if(!("full-page"!==u||s.results.length||s.hasMore||x.loadingDeletedResults(n())||c!==R.SearchType.ALL||0!==x.fileCategoriesArray(n()).length||x.filteredAccountId(n())))return e($({loadingDeletedResults:!0})),e(t.fetchImageSuggestionCount()),void t.fetchFirstPage(e,n);e(t.setResults({searchResults:s,context:f,requestId:g})),s.hasMore||e(t.logQueryCompleted()),"full-page"===u&&(e(t.handleComponentTTI({component:"results",query:o})),e(t.startDwellTime()),e(h.resetScroll())),"full-page"===u&&s.hasMore?e(Z({loadingState:R.SearchLoadingState.LOADING_ADDITIONAL_PAGE})):(e(Z({loadingState:R.SearchLoadingState.LOADED})),c===R.SearchType.ALL&&e($({loadingDeletedResults:!0}))),"full-page"===u&&(se(),z=setTimeout((function(){t.hasSearchChanged(n(),{query:o,path:a,filteredAccountId:p,searchType:c,fileCategoriesString:d})||(e(t.fetchNextPage()),e(t.fetchImageSuggestionCount()))}),P.SEARCH_SECOND_PAGE_DEBOUNCE),!l&&s.results.length&&_.initializeStore(i,s.results.filter(ue)),C.checkForMissingStarredData({items:s.results,user:i})),U.get_timer(P.SEARCH_WEB_TIMER).end()}},onError:function(r){var i=(new Date).getTime()-x.queryStartTime(n());D.logQueryFailed(i,r,s),V.reportException({err:new Error(r),severity:"non-critical",tags:["js:search"]}),e(Z({loadingState:R.SearchLoadingState.LOAD_ERROR})),e(t.handleComponentTTI({component:"results",query:o}))}}))}},t.resetTTI=function(){return function(e,t){e(J()),U.get_timer(P.SEARCH_WEB_TIMER).restart(),U.get_timer(P.SEARCH_WEB_TIMER).initialize({requireTTI:!0,requireTTV:!1,url:P.SEARCH_WEB_TIMER})}},t.handleComponentTTI=function(e){var t=e.component,r=e.query;return function(e,n){x.ttiComponents(n()).has(t)||Q.normalize(r)===x.normalizedQuery(n())&&("results"===t&&U.get_timer(P.SEARCH_WEB_TIMER).fetchedDataRequiredForTTI(),e(X({component:t})),x.ttiComponentsAllLoaded(n())&&U.get_timer(P.SEARCH_WEB_TIMER).markTimeToInteractive())}},t.fetchImageSuggestionCount=function(){return function(e,n){var s=x.user(n()),i=x.path(n()),a=x.query(n()),o=x.searchType(n()),l=L.searchResultsExperiments(n()),c=l.expImageContentSearchDiscovery,u=x.fileCategoriesString(n()),d=x.filteredAccountId(n()),p=!!l.expImageContentSearch&&o!==R.SearchType.IMAGE&&!!c&&c!==M.ImageSearchDiscoveryVariants.OFF&&c!==M.ImageSearchDiscoveryVariants.NONE;s&&p&&F.searchApiClient.loadPartialResults(r.__assign(r.__assign({},ne(n())),{start:0,deleted:!1,includeBrowseContext:!1,maxResults:100,searchType:R.SearchType.IMAGE,skipLogging:!0,getSuggestion:!0,onSuccess:function(r){var s=r.searchResults,l=r.requestId;t.hasSearchChanged(n(),{query:a,path:i,filteredAccountId:d,fileCategoriesString:u,searchType:o})||e(ee({results:s.results,query:a,requestId:l}))}}))}},t.startDwellTime=function(e){var t=(void 0===e?{startTime:Date.now()}:e).startTime;return{type:O.ActionTypes.SET_DWELL_TIME,payload:{dwellStartTime:t}}},t.stopAndLogDwellTime=function(){return function(e,r){var n=r(),s=x.dwellStartTime(n);if(void 0!==s){var i=Date.now()-s;D.logDwellTime(i,g.viewType(n)),e(t.startDwellTime({startTime:void 0}))}}},t.loadHistory=function(){return function(e,t){var r=x.user(t());if(r){var n=H.UserLocalStorage.get(r.id,R.SEARCH_RECENT_HISTORY_STORAGE_KEY)||[];e({type:O.ActionTypes.SET_QUERY_HISTORY,payload:{queryHistory:n}})}}},t.addQueryToHistory=function(){return function(e,t){var n=x.user(t());if(n){var s=x.queryHistory(t()),i=x.resultQuery(t()),a=s.indexOf(s.find((function(e){return e.rawQuery===i}))),o=r.__spreadArrays([{rawQuery:i,normalizedQuery:i}],s.filter((function(e){return e.rawQuery!==i}))).slice(0,R.SEARCH_RECENT_HISTORY_CAPACITY);e({type:O.ActionTypes.SET_QUERY_HISTORY,payload:{queryHistory:o}}),H.UserLocalStorage.set(n.id,R.SEARCH_RECENT_HISTORY_STORAGE_KEY,o),D.logHistoryAdded(a)}}},t.clearAllHistory=function(){return function(e,t){var r=x.user(t());r&&(e({type:O.ActionTypes.SET_QUERY_HISTORY,payload:{queryHistory:[]}}),H.UserLocalStorage.delete(r.id,R.SEARCH_RECENT_HISTORY_STORAGE_KEY),D.logHistoryCleared())}},t.fetchQuerySuggestions=function(e){var n=this,s=e.query,i=e.maxResults;return function(e,a){return r.__awaiter(n,void 0,void 0,(function(){var n,o,l,c,u,d,p,_,h,g;return r.__generator(this,(function(r){switch(r.label){case 0:if(!(n=x.user(a())))return[2];if(o=Q.normalize(s),l=x.querySuggestionsCache(a())[o]){if((c=l.loadingState)===M.QuerySuggestionsLoadingState.LOADING)return[2];if(l.lastFetched&&Date.now()-l.lastFetched<R.TIME_TO_INVALIDATE_QUERY_SUGGESTIONS_CACHE){if(c===M.QuerySuggestionsLoadingState.LOADED)return e(t.setLastQueryWithQuerySuggestionsLoaded({lastQueryWithQuerySuggestionsLoaded:o})),[2];if(c===M.QuerySuggestionsLoadingState.DISMISSED)return e(Y({normalizedQuery:o,querySuggestionsData:{loadingState:M.QuerySuggestionsLoadingState.LOADED}})),e(t.setLastQueryWithQuerySuggestionsLoaded({lastQueryWithQuerySuggestionsLoaded:o})),[2]}}u=x.sessionId(a()),e(Y({normalizedQuery:o,querySuggestionsData:{suggestions:[],loadingState:M.QuerySuggestionsLoadingState.LOADING}})),d=Date.now(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,A.getQuerySuggestions(n.id,o,i,u)];case 2:return p=r.sent().query_suggestions,e(Y({normalizedQuery:o,querySuggestionsData:{suggestions:(_=p||[]).filter((function(e){return e.text!==o})),loadingState:M.QuerySuggestionsLoadingState.LOADED,lastFetched:Date.now()}})),e(t.setLastQueryWithQuerySuggestionsLoaded({lastQueryWithQuerySuggestionsLoaded:o})),D.logQuerySuggestionsFetched(o,_.length,Date.now()-d),[3,4];case 3:return h=r.sent(),g=h.raw?new Error(h.raw.responseBody):h,V.reportException({err:g,tags:["search_bar","search_bar_query_suggestions"],severity:"non-critical"}),e(Y({normalizedQuery:o,querySuggestionsData:{loadingState:M.QuerySuggestionsLoadingState.FAILED,lastFetched:Date.now()}})),D.logQuerySuggestionsFailed(o),[3,4];case 4:return[2]}}))}))}},t.dismissQuerySuggestions=function(e){var t=e.query;return function(e,r){var n=Q.normalize(t),s=x.querySuggestionsCache(r())[n];s&&s.loadingState===M.QuerySuggestionsLoadingState.LOADED&&(e(Y({normalizedQuery:n,querySuggestionsData:{loadingState:M.QuerySuggestionsLoadingState.DISMISSED}})),D.logQuerySuggestionsDismissed(t))}};var Y=function(e){var t=e.normalizedQuery,r=e.querySuggestionsData;return{type:O.ActionTypes.UPDATE_QUERY_SUGGESTIONS_CACHE,payload:{normalizedQuery:t,querySuggestionsData:r}}};t.setLastQueryWithQuerySuggestionsLoaded=function(e){var t=e.lastQueryWithQuerySuggestionsLoaded;return function(e,r){e({type:O.ActionTypes.SET_LAST_QUERY_WITH_QUERY_SUGGESTIONS_LOADED,payload:{lastQueryWithQuerySuggestionsLoaded:t}})}},t.setResults=function(e){var t=e.searchResults,r=e.requestId,n=e.context;return{type:O.ActionTypes.SET_RESULTS,payload:{searchResults:t,requestId:r,context:n}}},t.updateResults=function(e){var t=e.results;return{type:O.ActionTypes.UPDATE_RESULTS,payload:{results:t}}},t.removeResults=function(e){var t=e.results;return{type:O.ActionTypes.REMOVE_RESULTS,payload:{results:t}}},t.renameFile=function(e){var s=e.file,i=e.name,o=e.checkFSWs;return function(e,l){return r.__awaiter(this,void 0,void 0,(function(){var c,u,d,p;return r.__generator(this,(function(_){switch(_.label){case 0:return-1!==i.indexOf("/")?(T.Snackbar.fail(G._("Name was invalid."),"browse-action"),e(h.setFileRename({file:s,renameState:null})),[2]):(c=x.user(l()))?(e(h.setFileRename({file:s,renameState:v.RenameState.SAVING_INPUT})),T.Snackbar.sync(G._("Renaming"),!1,"browse-action"),[4,f.renameFile(s,i,c,o)]):[2];case 1:return(u=_.sent()).isError?"to"===u.error[".tag"]&&"file_system_warnings"===u.error.to[".tag"]?(T.Snackbar.close("browse-action"),a.showFileSystemWarningsModal({fsws:u.error.to.details,onFinalAccept:function(){e(t.renameFile({file:s,name:i,checkFSWs:!1}))},onAbortAction:function(){e(h.setFileRename({file:s,renameState:null}))},confirmText:G._("Rename")})):(e(h.setFileRename({file:s,renameState:null})),T.Snackbar.fail(y.renameError(u.error,s.fq_path),"browse-action")):(d=m.fileFromMetadata(s,u.result.metadata),e(t.setSelection({selection:new w.Selection({selected:n.OrderedSet(),anchor:null}),skipLogging:!0})),e(t.updateResults({results:[d]})),e(h.setFileRename({file:s,renameState:null})),p=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return T.Snackbar.sync(G._("Undoing"),!1,"browse-action"),[4,f.undo(u.result.changeset_data,c)];case 1:return r.sent().isError?T.Snackbar.fail(G._("Undo failed."),"browse-action"):(T.Snackbar.complete(G._("Undo complete."),"browse-action"),e(t.updateResults({results:[s]}))),[2]}}))}))},k.setHandleUndo(p),T.Snackbar.completeWithUndo(G._("Rename complete."),p,"browse-action")),[2]}}))}))}},t.deleteFiles=function(e){var n=e.files,s=e.user,i=e.context,l=e.checkFSWs;return function(e,c){return r.__awaiter(this,void 0,void 0,(function(){var u=this;return r.__generator(this,(function(_){return a.showDelete(s,n,i,"/",(function(){return r.__awaiter(u,void 0,void 0,(function(){var u,_,h,m,v,w,C,F,R,A,I,b,P,L,O,D=this;return r.__generator(this,(function(N){switch(N.label){case 0:return u=function(e){var t=e.eventName,r=e.num_files_selected,n=e.num_folders_selected,i=e.error_summary;o.logFileAction({uid:s.id,action:t,num_files_selected:r,num_folders_selected:n,view_type:g.viewType(c()),error_summary:i})},T.Snackbar.sync(G.ungettext("Deleting %(num_files)s item...","Deleting %(num_files)s items...",n.length).format({num_files:n.length}),!0,"browse-action"),[4,f.deleteFiles(n,s.id,l)];case 1:return(_=N.sent()).isError?("path"===_.error[".tag"]&&"file_system_warnings"===_.error.path[".tag"]?(T.Snackbar.close("browse-action"),a.showFileSystemWarningsModal({fsws:_.error.path.details,onFinalAccept:function(){e(t.deleteFiles({user:s,files:n,context:i,checkFSWs:!1}))},confirmText:G._("Delete")})):T.Snackbar.fail(y.deleteError(n.length,_.error),"browse-action"),h=x.selectedFiles(c()),m=d.countFilesAndFolders(h),v=m.num_files_selected,w=m.num_folders_selected,u({eventName:W.WebUserActionLogEvent.DELETE_REQUEST_FAIL,error_summary:_.error_summary,num_files_selected:v,num_folders_selected:w})):(C=function(e){return"success"===e[".tag"]},F=_.result.entries.filter(C),R=F.map((function(e){return e.metadata.path_display})),A=function(e){return void 0!==e},I=function(e,t,n){return t.reduce((function(t,s){if(A(s)){var i=n.find((function(e){return E.isFile(e)&&e.fq_path===s}));return void 0!==i&&E.isFile(i)?r.__spreadArrays(t,[new p.File(r.__assign(r.__assign({},i),{isDeleted:e,thumbnail_url_tmpl:e?null:i.thumbnail_url_tmpl}))]):t}return t}),[])},e(t.updateResults({results:I(!0,R,x.results(c()))})),b=function(){return r.__awaiter(D,void 0,void 0,(function(){return r.__generator(this,(function(r){return T.Snackbar.close("browse-action"),u({eventName:W.WebUserActionLogEvent.DELETE_UNDO,num_files_selected:_.result.changeset_data.length,num_folders_selected:0}),S.rollback({changeset_data:_.result.changeset_data,userId:s.id,onSuccess:function(){T.Snackbar.complete(G._("Delete undone."),"browse-action"),u({eventName:W.WebUserActionLogEvent.DELETE_UNDO_REQUEST_SUCCESS,num_files_selected:_.result.changeset_data.length,num_folders_selected:0}),e(t.updateResults({results:I(!1,R,x.results(c()))}))}}),[2]}))}))},k.setHandleUndo(b),P=function(e){return"failure"===e[".tag"]},L=_.result.entries.filter(P),O=L.length>0?L[0].failure[".tag"]:void 0,L.length===_.result.entries.length?(T.Snackbar.fail(y.deleteCompleteError(L),"browse-action"),u({eventName:W.WebUserActionLogEvent.DELETE_REQUEST_FAIL,num_files_selected:_.result.changeset_data.length,num_folders_selected:0,error_summary:O})):(T.Snackbar.completeWithUndo(y.deleteCompleteSuccess(n.length,F.length),b,"browse-action"),u({eventName:W.WebUserActionLogEvent.DELETE_REQUEST_SUCCESS,num_files_selected:_.result.changeset_data.length,num_folders_selected:0,error_summary:O}))),[2]}}))}))})),[2]}))}))}},t.purgeFiles=function(n){var s=n.files,i=n.user,o=n.context;return function(n,l){return r.__awaiter(this,void 0,void 0,(function(){var l;return r.__generator(this,(function(c){switch(c.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/trash/actions"],t,r)})).then(r.__importStar)];case 1:return l=c.sent().purgeByPathBatch,a.showPurgeModal({userId:i.id,context:o,files:s,onPurge:function(){return l(i.id,s,(function(e){n(t.removeResults({results:e}))}))}}),[2]}}))}))}},t.restoreFiles=function(e){var n=e.files,i=e.user,o=e.context;return function(e,c){return r.__awaiter(this,void 0,void 0,(function(){var u;return r.__generator(this,(function(d){return u=function(n){var s=n.map((function(e){return e.fq_path})),i=x.results(c()).reduce((function(e,t){return E.isFile(t)&&s.includes(t.fq_path)?r.__spreadArrays(e,[new p.File(r.__assign(r.__assign({},t),{isDeleted:!1}))]):e}),[]);e(t.updateResults({results:i}))},a.showUnifiedTrashModal({userId:i.id,context:o,files:n,onRestore:function(e,t){l.restoreFiles({files:t,userId:i.id,onSuccess:function(){s.notifyRestoreSuccess(t),u(t)},isSearchMode:!1})}}),[2]}))}))}};var j=function(){return{type:O.ActionTypes.CLEAR_RESULTS}},K=function(e){var t=e.searchResults,r=e.loadingState;return{type:O.ActionTypes.APPEND_RESULTS,payload:{searchResults:t,loadingState:r}}},Z=function(e){var t=e.loadingState;return{type:O.ActionTypes.SET_LOADING_STATE,payload:{loadingState:t}}},J=function(){return{type:O.ActionTypes.CLEAR_TTI_COMPONENTS}},X=function(e){var t=e.component;return{type:O.ActionTypes.ADD_TTI_COMPONENT,payload:{component:t}}},$=function(e){var t=e.loadingDeletedResults;return{type:O.ActionTypes.SET_LOADING_DELETED_RESULTS,payload:{loadingDeletedResults:t}}},ee=function(e){var t=e.results,r=e.query,n=e.requestId;return{type:O.ActionTypes.SET_IMAGE_SUGGESTION,payload:{results:t,query:r,requestId:n}}},te=function(e){var t=e.normalizedQuery,r=e.peopleSuggestionsData;return{type:O.ActionTypes.UPDATE_PEOPLE_SUGGESTIONS_CACHE,payload:{normalizedQuery:t,peopleSuggestionsData:r}}},re=function(e){var t=e.lastQueryWithPeopleSuggestionsLoaded;return{type:O.ActionTypes.SET_LAST_QUERY_WITH_PEOPLE_SUGGESTIONS_LOADED,payload:{lastQueryWithPeopleSuggestionsLoaded:t}}};t.setHighlightedRow=function(e){var t=e.index;return{type:O.ActionTypes.SET_HIGHLIGHTED_ROW,payload:{index:t}}},t.setQueryStartTime=function(e){var t=e.queryStartTime;return{type:O.ActionTypes.SET_QUERY_START_TIME,payload:{queryStartTime:t}}},t.logQueryCompleted=function(){return function(e,n){return r.__awaiter(this,void 0,void 0,(function(){var s;return r.__generator(this,(function(r){return(s=x.queryStartTime(n()))&&(D.logQueryCompleted((new Date).getTime()-s),e(t.setQueryStartTime({queryStartTime:void 0}))),[2]}))}))}};var ne=function(e){return{user:x.user(e),path:x.path(e),query:x.normalizedQuery(e),searchSessionId:x.sessionId(e),deleted:x.loadingDeletedResults(e),includeBrowseContext:!1,searchResultsExperiments:L.searchResultsExperiments(e),searchType:x.searchType(e),skipLogging:!0,fileCategories:x.fileCategories(e),isPaperEnabled:x.isPaperEnabled(e),sortOrder:x.sortOrder(e),filteredAccountId:x.filteredAccountId(e),maxResults:L.maxResultsToFetch(e)}},se=function(){B=ie(B),z=ie(z)},ie=function(e){return null!==e&&clearTimeout(e),null},ae=function(e){switch(e){case c.SEARCH_ORDER_BY_TYPE.LAST_MODIFIED_TIME:return v.SortField.MODIFIED;case c.SEARCH_ORDER_BY_TYPE.RELEVANCE:default:return v.SortField.RELEVANCE}},oe=function(e){switch(e){case R.SearchOriginPathway.ASSISTANT:return R.SearchOriginPathway.ASSISTANT;case R.SearchOriginPathway.COLLAB_BROWSE:return R.SearchOriginPathway.COLLAB_BROWSE;default:return R.SearchOriginPathway.WEB}},le=function(e){switch(e){case c.SEARCH_REVERSE_ORDER_TYPE.TRUE:return v.SortDirection.ASCENDING;case c.SEARCH_REVERSE_ORDER_TYPE.FALSE:default:return v.SortDirection.DESCENDING}},ce=function(e,t){return!e&&!t||!(!e||!t)&&(e.sortField===t.sortField&&e.sortDirection===t.sortDirection)};t.setFilters=function(e){var r=e.path,n=e.fileCategories,s=e.searchType,a=e.filteredAccountId;return function(e,o){var l=o();r&&!i.paths_are_equal(r,x.path(l))&&e(t.setPath({path:r,viewport:"view"})),n&&e(t.setFileCategories({fileCategories:n})),s&&e(t.setSearchType({searchType:s})),null===a&&e(t.setFilteredAccountId({filteredAccountId:void 0}))}},t.resetFilters=function(){return function(e){e(t.setFilters({path:"/",fileCategories:R.FILE_CATEGORIES_UNCHECKED,filteredAccountId:null})),D.logFiltersReset()}};var ue=function(e){return e instanceof p.File};t.hasSearchChanged=function(e,t){var r=t.path,n=t.query,s=t.filteredAccountId,a=t.fileCategoriesString,o=t.searchType;return!i.paths_are_equal(r,x.path(e))||(Q.normalize(n)!==x.normalizedQuery(e)||(s!==x.filteredAccountId(e)||(a!==x.fileCategoriesString(e)||o!==x.searchType(e))))},t.shouldStartNewSearchSession=function(e,t){var r=t.query;return!x.sessionId(e)||(!(!x.normalizedQuery(e)||r)||x.normalizedQuery(e).length>=3&&1===r.length)}})),define("modules/clean/search/single_page/data/reducer",["require","exports","tslib","immutable","modules/clean/react/browse/models","modules/clean/react/files_view/types","modules/clean/react/selection","modules/clean/search/constants","modules/clean/search/single_page/data/types","modules/clean/search/single_page/utils","modules/clean/search/store_helpers"],(function(e,t,r,n,s,i,a,o,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),t.defaultSearchState={variant:"full-page",loadingState:o.SearchLoadingState.ZERO_QUERY,results:n.OrderedMap(),query:"",resultQuery:"",path:"/",sessionId:"",selection:a.createSelection(),queryHistory:[],previewFileId:void 0,sortOrder:{sortField:i.SortField.RELEVANCE,sortDirection:i.SortDirection.DESCENDING},fileCategories:o.FILE_CATEGORIES_UNCHECKED,context:new s.BrowseContext,ttiComponents:n.Set(),loadingDeletedResults:!1,searchType:o.SearchType.ALL,imageSuggestionCount:0,imageSuggestionQuery:"",imageSuggestionRequestId:void 0,imageSuggestionResults:n.OrderedMap(),filteredAccountId:void 0,peopleSuggestionsCache:{},lastQueryWithPeopleSuggestionsLoaded:void 0,querySuggestionsCache:{},spellCorrection:void 0};var d=function(e){return r.__assign(r.__assign({},e),{results:e.results.clear(),resultQuery:"",nextPageOffset:0,hasMoreResults:!0,selection:a.createSelection(),imageSuggestionCount:0,imageSuggestionQuery:"",imageSuggestionRequestId:void 0,spellCorrection:void 0})},p=function(e,t){return r.__assign(r.__assign({},e),{results:e.results.concat(t.searchResults.results.map((function(e){return[c.getIdForSearchResult(e),e]}))),cursor:t.searchResults.cursor,nextPageOffset:t.searchResults.nextPageOffset,resultQuery:u.normalize(e.query),hasMoreResults:t.searchResults.hasMore,loadingState:t.loadingState||e.loadingState})},_=function(e,t){return r.__assign(r.__assign({},e),{spellCorrection:t.searchResults.spellCorrection})},h=function(e,t){return r.__assign(r.__assign({},e),{requestId:t.requestId})};t.searchReducer=function(e,s){switch(void 0===e&&(e=t.defaultSearchState),s.type){case l.ActionTypes.SET_VARIANT:return(function(e,t){return r.__assign(r.__assign({},e),{variant:t.variant})})(e,s.payload);case l.ActionTypes.SET_USER:return(function(e,t){return r.__assign(r.__assign({},e),{user:t.user,userOptions:t.options})})(e,s.payload);case l.ActionTypes.SET_EXPERIMENTS:return(function(e,t){return r.__assign(r.__assign({},e),{experiments:t.experiments})})(e,s.payload);case l.ActionTypes.SET_PATH:return(function(e,t){return r.__assign(r.__assign({},e),{path:t.path})})(e,s.payload);case l.ActionTypes.SET_FILE_CATEGORIES:return(function(e,t){return r.__assign(r.__assign({},e),{fileCategories:t.fileCategories})})(e,s.payload);case l.ActionTypes.SET_LOADING_STATE:return(function(e,t){return r.__assign(r.__assign({},e),{loadingState:t.loadingState})})(e,s.payload);case l.ActionTypes.SET_QUERY:return(function(e,t){return r.__assign(r.__assign({},e),{query:t.query,highlightedRow:void 0})})(e,s.payload);case l.ActionTypes.SET_RESULTS:return(function(e,t){var n=t.searchResults,s=t.requestId,i=t.context,a=r.__assign(r.__assign({},e),{context:i||e.context});return a=d(a),a=p(a,{searchResults:n}),a=h(a,{requestId:s}),a=_(a,{searchResults:n})})(e,s.payload);case l.ActionTypes.CLEAR_RESULTS:return d(e);case l.ActionTypes.APPEND_RESULTS:return p(e,s.payload);case l.ActionTypes.SET_SESSION_ID:return(function(e,t){return r.__assign(r.__assign({},e),{sessionId:t.sessionId})})(e,s.payload);case l.ActionTypes.SET_REQUEST_ID:return h(e,s.payload);case l.ActionTypes.SET_SELECTION:return(function(e,t){return r.__assign(r.__assign({},e),{selection:t.selection})})(e,s.payload);case l.ActionTypes.SET_PREVIEW_FILE_ID:return(function(e,t){return r.__assign(r.__assign({},e),{previewFileId:t.previewFileId})})(e,s.payload);case l.ActionTypes.SET_SORT_ORDER:return(function(e,t){return r.__assign(r.__assign({},e),{sortOrder:t.sortOrder})})(e,s.payload);case l.ActionTypes.ADD_TTI_COMPONENT:return(function(e,t){return r.__assign(r.__assign({},e),{ttiComponents:e.ttiComponents.add(t.component)})})(e,s.payload);case l.ActionTypes.CLEAR_TTI_COMPONENTS:return(function(e){return r.__assign(r.__assign({},e),{ttiComponents:n.Set()})})(e);case l.ActionTypes.SET_LOADING_DELETED_RESULTS:return(function(e,t){return r.__assign(r.__assign({},e),{loadingDeletedResults:t.loadingDeletedResults,nextPageOffset:0,hasMoreResults:t.loadingDeletedResults||e.hasMoreResults})})(e,s.payload);case l.ActionTypes.SET_SEARCH_TYPE:return(function(e,t){return r.__assign(r.__assign({},e),{searchType:t.searchType})})(e,s.payload);case l.ActionTypes.SET_IMAGE_SUGGESTION:return(function(e,t){var n=e.imageSuggestionResults.clear();return r.__assign(r.__assign({},e),{imageSuggestionResults:n.concat(t.results.map((function(e){return[c.getIdForSearchResult(e),e]}))),imageSuggestionCount:t.results.length,imageSuggestionQuery:t.query,imageSuggestionRequestId:t.requestId})})(e,s.payload);case l.ActionTypes.SET_DWELL_TIME:return(function(e,t){return r.__assign(r.__assign({},e),{dwellStartTime:t.dwellStartTime})})(e,s.payload);case l.ActionTypes.UPDATE_RESULTS:return(function(e,t){var n=e.results.map((function(e){var r=t.results.find((function(t){return c.getIdForSearchResult(e)===c.getIdForSearchResult(t)}));return void 0===r?e:r}));return r.__assign(r.__assign({},e),{results:n})})(e,s.payload);case l.ActionTypes.REMOVE_RESULTS:return(function(e,t){var n=t.results.map((function(e){return c.getIdForSearchResult(e)})),s=e.results.filter((function(e){return!n.includes(c.getIdForSearchResult(e))}));return r.__assign(r.__assign({},e),{results:s})})(e,s.payload);case l.ActionTypes.SET_QUERY_HISTORY:return(function(e,t){var n=t.queryHistory;return r.__assign(r.__assign({},e),{queryHistory:n})})(e,s.payload);case l.ActionTypes.SET_HIGHLIGHTED_ROW:return(function(e,t){return r.__assign(r.__assign({},e),{highlightedRow:t.index})})(e,s.payload);case l.ActionTypes.UPDATE_QUERY_SUGGESTIONS_CACHE:return(function(e,t){var n,s=t.normalizedQuery,i=t.querySuggestionsData;return r.__assign(r.__assign({},e),{querySuggestionsCache:r.__assign(r.__assign({},e.querySuggestionsCache),(n={},n[s]=r.__assign(r.__assign({},e.querySuggestionsCache[s]),i),n))})})(e,s.payload);case l.ActionTypes.SET_LAST_QUERY_WITH_QUERY_SUGGESTIONS_LOADED:return(function(e,t){var n=t.lastQueryWithQuerySuggestionsLoaded;return r.__assign(r.__assign({},e),{lastQueryWithQuerySuggestionsLoaded:n})})(e,s.payload);case l.ActionTypes.SET_FILTERED_ACCOUNT_ID:return(function(e,t){return r.__assign(r.__assign({},e),{filteredAccountId:t.filteredAccountId})})(e,s.payload);case l.ActionTypes.UPDATE_PEOPLE_SUGGESTIONS_CACHE:return(function(e,t){var n,s=t.normalizedQuery,i=t.peopleSuggestionsData;return r.__assign(r.__assign({},e),{peopleSuggestionsCache:r.__assign(r.__assign({},e.peopleSuggestionsCache),(n={},n[s]=r.__assign(r.__assign({},e.peopleSuggestionsCache[s]),i),n))})})(e,s.payload);case l.ActionTypes.SET_LAST_QUERY_WITH_PEOPLE_SUGGESTIONS_LOADED:return(function(e,t){return r.__assign(r.__assign({},e),{lastQueryWithPeopleSuggestionsLoaded:t.lastQueryWithPeopleSuggestionsLoaded})})(e,s.payload);case l.ActionTypes.SET_QUERY_START_TIME:return(function(e,t){return r.__assign(r.__assign({},e),{queryStartTime:t.queryStartTime})})(e,s.payload);default:return e}}})),define("modules/clean/search/single_page/data/selectors/experiments",["require","exports","tslib","reselect","modules/clean/react/browse/models","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/clean/search/constants","modules/clean/search/search_bar/experiments","modules/clean/search/single_page/constants","modules/clean/search/single_page/data/selectors/index","modules/clean/search/types","modules/core/i18n","dropbox/proto/js_init_data/browse_web/browse_web"],(function(e,t,r,n,s,i,a,o,l,c,u,d,p,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),l=r.__importStar(l),u=r.__importStar(u);t.experiments=function(e){return(function(e){return a.getStateAtNamespace(e,i.SEARCH_NAMESPACE_KEY)})(e).experiments||{}};var h=function(e,t){return e&&e[t]||"OFF"},g=function(e,t){return!!e&&!0===e[t]};t.searchBarExperiments=n.createSelector(t.experiments,(function(e){return{expPeopleFilter:h(e,"search_experiment_people_filter"),expSearchSuccessBanner:g(e,"search_success_qualitative_metric")}})),t.searchResultsExperiments=n.createSelector(t.experiments,(function(e){return{expImageContentSearch:g(e,"search_image_content"),expImageContentSearchDiscovery:h(e,"search_image_search_discovery"),expImageFeedbackBanner:g(e,"search_experiment_image_feedback_banner"),expSatisfactionBanner:g(e,"search_experiment_satisfaction_banner"),expSnippets:g(e,"search_experiment_snippets_web")}})),t.browseExperiments=n.createSelector(t.experiments,(function(e){return _.browse_web.BrowseExperiments.create({folderHistoryRollbacks:g(e,"folder_history_rollbacks")})})),t.isInPeopleFilterExperiment=n.createSelector(t.searchBarExperiments,u.isFullPage,(function(e,t){return t&&e.expPeopleFilter===d.PeopleFilterVariants.ON})),t.isSearchAsYouTypeEnabled=n.createSelector(t.experiments,u.isFullPage,(function(e,t){return!t||"ON"!==e.search_experiment_disable_sayt&&"ON_WITH_SUGGESTIONS"!==e.search_experiment_disable_sayt})),t.tabs=n.createSelector(t.experiments,u.imageSuggestionCount,(function(e,t){var r=e.search_image_search_discovery===d.ImageSearchDiscoveryVariants.TAB&&t>0?p._("Images (%(count)d)").format({count:t}):p._("Images");return e.search_image_content?[{id:o.SearchType.ALL,label:p._("Text")},{id:o.SearchType.IMAGE,label:r}]:void 0})),t.shouldRenderTabs=n.createSelector(t.tabs,(function(e){return!(!e||!e.length)})),t.shouldRenderHistory=n.createSelector(u.loadingState,u.queryHistory,(function(e,t){return e===o.SearchLoadingState.ZERO_QUERY&&0!==t.length})),t.shouldRenderEmptyZeroQueryView=n.createSelector(t.shouldRenderHistory,(function(e){return!e})),t.shouldShowImagePanel=n.createSelector(t.searchResultsExperiments,(function(e){return e.expImageContentSearchDiscovery===d.ImageSearchDiscoveryVariants.IMAGE_PANEL}));var f=function(e,t){var r=t.responsive;return!(!r||!r.isResponsive||r.isMatchedLarge)};t.shouldShowSelectionPreviewPane=n.createSelector(f,u.results,(function(e,t){var r=t.size;return!(e||!(r>0))})),t.isFolderOverviewEnabled=n.createSelector(t.experiments,(function(e){return"V3"===e.browse_web_folder_overview})),t.shouldShowFolderOverview=n.createSelector(f,u.selectedFiles,t.experiments,(function(e,t,r){return!e&&1===t.size&&t.first().is_dir&&!s.File.isNoAccessSharedFolder(t.first())})),t.artificalLatency=n.createSelector(t.experiments,(function(e){switch(e.search_experiment_artificial_latency){case"ON_100":return 100;case"ON_250":return 250;case"ON_500":return 500;case"ON_1000":return 1e3;default:return 0}})),t.shouldRenderInlineSearchFilters=n.createSelector(u.hasResultQuery,u.filteredAccountId,(function(e,t){return Boolean(e||t)})),t.getExpSearchSuccessBanner=function(e){return l.isInSearchSuccessBannerExperiment(t.searchBarExperiments(e))},t.maxResultsToFetch=n.createSelector(u.variant,u.nextPageOffset,t.isSearchAsYouTypeEnabled,(function(e,t,r){return t?c.SEARCH_ADDITIONAL_PAGE_SIZE:"dropdown"===e?c.SEARCH_DROPDOWN_PAGE_SIZE:r?c.SEARCH_FIRST_PAGE_SIZE:c.SEARCH_ADDITIONAL_PAGE_SIZE}))})),define("modules/clean/search/single_page/data/selectors/index",["require","exports","tslib","immutable","reselect","modules/clean/filepath","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/files_view/types","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/clean/search/api_helpers","modules/clean/search/constants","modules/clean/search/search_helpers","modules/clean/search/single_page/navigation","modules/clean/search/single_page/utils","modules/clean/search/store_helpers","modules/clean/search/types","modules/core/i18n"],(function(e,t,r,n,s,i,a,o,l,c,u,d,p,_,h,g,f,m,S,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),i=r.__importStar(i);var v=function(e){return d.getStateAtNamespace(e,u.SEARCH_NAMESPACE_KEY)};t.variant=function(e){return v(e).variant},t.isFullPage=function(e){return"full-page"===v(e).variant},t.user=function(e){return v(e).user},t.userOptions=function(e){return v(e).userOptions},t.loadingState=function(e){return v(e).loadingState},t.results=function(e){return v(e).results},t.query=function(e){return v(e).query},t.resultQuery=function(e){return v(e).resultQuery},t.hasResultQuery=function(e){return!!v(e).resultQuery},t.normalizedQuery=function(e){return m.normalize(v(e).query)},t.path=function(e){return v(e).path},t.sessionId=function(e){return v(e).sessionId},t.requestId=function(e){return v(e).requestId},t.selection=function(e){return v(e).selection},t.queryHistory=function(e){return v(e).queryHistory},t.nextPageOffset=function(e){return v(e).nextPageOffset},t.cursor=function(e){return v(e).cursor},t.spellCorrection=function(e){return v(e).spellCorrection},t.hasMoreResults=function(e){return v(e).hasMoreResults},t.previewFileId=function(e){return v(e).previewFileId},t.sortOrder=function(e){return v(e).sortOrder},t.cachedFullResults=function(e){return v(e).cachedFullResults},t.cachedFullResultsSortField=function(e){return v(e).cachedFullResultsSortField},t.fileCategories=function(e){return v(e).fileCategories},t.context=function(e){return v(e).context},t.ttiComponents=function(e){return v(e).ttiComponents},t.searchType=function(e){return v(e).searchType},t.imageSuggestionQuery=function(e){return v(e).imageSuggestionQuery},t.imageSuggestionCount=function(e){return v(e).imageSuggestionCount},t.imageSuggestionRequestId=function(e){return v(e).imageSuggestionRequestId},t.imageSuggestionResults=function(e){return v(e).imageSuggestionResults.toList()},t.highlightedRow=function(e){return v(e).highlightedRow},t.filteredAccountId=function(e){return v(e).filteredAccountId},t.peopleSuggestionsCache=function(e){return v(e).peopleSuggestionsCache},t.lastQueryWithPeopleSuggestionsLoaded=function(e){return v(e).lastQueryWithPeopleSuggestionsLoaded},t.dwellStartTime=function(e){return v(e).dwellStartTime},t.queryStartTime=function(e){return v(e).queryStartTime};var E=function(){return h.getSearchCsrfToken()};t.resultsList=s.createSelector(t.results,(function(e){return e.toList()})),t.isNautilusEnabled=s.createSelector(t.userOptions,(function(e){return e&&e.nautilus_enabled})),t.isPaperEnabled=s.createSelector(t.userOptions,(function(e){return e&&e.paper_enabled})),t.preferredEditors=s.createSelector(t.user,t.userOptions,(function(e,t){var r,n;return e?t&&t.preferred_editors?((n={})[e.id]=t.preferred_editors,n):((r={})[e.id]={},r):{}})),t.fileCategoriesString=s.createSelector(t.fileCategories,(function(e){return h.fileCategoriesToString(e)})),t.fileCategoriesArray=s.createSelector(t.fileCategories,(function(e){return Object.keys(e).filter((function(t){return"checked"===e[t]}))})),t.fileCategoriesLogValue=s.createSelector(t.fileCategories,t.isPaperEnabled,(function(e,t){if(h.allCategoriesUnchecked(e,t))return["all_unchecked"];if(h.allCategoriesChecked(e,t))return["all_checked"];var r=[];return Object.keys(e).forEach((function(t){"checked"===e[t]&&r.push(t)})),r})),t.loadingDeletedResults=function(e){return v(e).loadingDeletedResults},t.selectedFiles=s.createSelector(t.results,t.selection,(function(e,t){return w(e,t)})),t.selectFilesForSelection=function(e,r){return w(t.results(e),r.selection)};var w=function(e,t){return n.OrderedMap(t.selected.toArray().filter((function(e){return!!e})).map((function(t){return[t,e.find((function(e){return"fq_path"in e?i.paths_are_equal(e.fq_path,t):e.file_id===t}))]})).filter((function(e){e[0];return!!e[1]})))},T=s.createSelector(t.resultsList,t.hasMoreResults,(function(e,t){return t?e.count()+1:e.count()}));t.commonLogFields=s.createSelector(t.user,t.path,t.query,t.sessionId,t.requestId,T,t.fileCategoriesLogValue,t.searchType,t.filteredAccountId,(function(e,t,r,n,s,a,o,l,c){return e?{user_id:e.id,active_user_id:e.id,path_scoped:!i.paths_are_equal(t),type:l===_.SearchType.IMAGE?"image_search":"single-page",query_string:r,typeahead_session_id:n,timezone_offset:p.getCurrentTimezoneOffset(),request_id:s,result_count:a,file_type_filters:o,search_scoped_to_account_id:c,source:g.searchNavigationManager.source}:{}})),t.searchUrl=s.createSelector(t.user,E,t.normalizedQuery,t.path,t.sessionId,t.previewFileId,t.fileCategoriesString,t.searchType,t.sortOrder,t.filteredAccountId,(function(e,t,r,n,s,i,o,u,d,p){if(e){var f=l.getQueryArgs().search_from;return h.buildSearchURL({user:e,searchPath:n,searchSessionId:s,searchToken:t,normalizedQuery:r,qargs:{search_from:f&&-1===g.DESKTOP_FROM_PATHS.indexOf(f)?f:void 0,preview:i,file_categories:o||void 0,search_type:u===_.SearchType.ALL?void 0:u,search_order_by:d.sortField===c.SortField.MODIFIED?a.SEARCH_ORDER_BY_TYPE.LAST_MODIFIED_TIME:void 0,search_reverse_order:d.sortDirection===c.SortDirection.ASCENDING?a.SEARCH_REVERSE_ORDER_TYPE.TRUE:void 0,search_account_id:p||void 0}}).toString()}})),t.searchUrlReset=s.createSelector(t.user,E,t.normalizedQuery,t.sessionId,t.searchType,(function(e,t,r,n,s){if(e)return h.buildSearchURL({user:e,searchPath:"/",searchSessionId:n,searchToken:t,normalizedQuery:r,qargs:{search_from:l.getQueryArgs().search_from||void 0,search_type:s===_.SearchType.ALL?void 0:s}}).toString()})),t.previewFile=s.createSelector(t.previewFileId,t.results,(function(e,t){return e?t.find((function(t){return t instanceof o.File&&t.file_id===e})):void 0})),t.previewableFiles=s.createSelector(t.resultsList,(function(e){return e.filter((function(e){return e instanceof o.File&&!e.isDeleted&&!e.is_cloud_doc&&!e.is_dir})).toArray()})),t.ttiComponentsAllLoaded=s.createSelector(t.ttiComponents,(function(e){return 3===e.size})),t.hasFiltersSelected=s.createSelector(t.path,t.fileCategoriesArray,(function(e,t){return!(i.paths_are_equal(e,"/")&&0===t.length)})),t.querySuggestionsCache=function(e){return v(e).querySuggestionsCache},t.lastQueryWithQuerySuggestionsLoaded=function(e){return v(e).lastQueryWithQuerySuggestionsLoaded},t.querySuggestions=s.createSelector(t.querySuggestionsCache,t.normalizedQuery,t.lastQueryWithQuerySuggestionsLoaded,(function(e,t,r){var n=e[t];return!r||n&&n.loadingState!==S.QuerySuggestionsLoadingState.LOADING?C(e,t):C(e,r)}));var C=function(e,t){var r=e[t];return r&&r.loadingState===S.QuerySuggestionsLoadingState.LOADED?r.suggestions:void 0};t.querySuggestionsLoadingState=s.createSelector(t.querySuggestionsCache,t.normalizedQuery,(function(e,t){return F(e,t)}));var F=function(e,t){var r=e[t];return r?r.loadingState:void 0};t.filteredContact=s.createSelector(t.peopleSuggestionsCache,t.filteredAccountId,(function(e,t){if(t){var r=e[""];return(r?r.contacts:[]).find((function(e){return e.dbx_account_id===t}))}})),t.filteredContactName=s.createSelector(t.filteredContact,(function(e){return e?e.name:void 0})),t.peopleSuggestions=s.createSelector(t.peopleSuggestionsCache,t.normalizedQuery,t.lastQueryWithPeopleSuggestionsLoaded,(function(e,t,r){var n=e[t];return!r||n&&n.loadingState!==S.PeopleSuggestionsLoadingState.LOADING?R(e,t):R(e,r)}));var R=function(e,t){var r=e[t];return r&&r.loadingState===S.PeopleSuggestionsLoadingState.LOADED?r.contacts.slice(0,Math.min(_.SEARCH_CONTACT_SUGGESTION_CAPACITY,r.contacts.length)):void 0};t.peopleSuggestionsLoadingState=s.createSelector(t.peopleSuggestionsCache,t.normalizedQuery,(function(e,t){var r=e[t];return r?r.loadingState:void 0})),t.suggestions=s.createSelector(t.peopleSuggestions,t.querySuggestions,t.resultQuery,(function(e,t,r){var n=[];return t&&n.push({suggestions:t.map((function(e){return{query:e.text,ariaLabel:y._("Search for %(query)s").format({query:e.text}),highlightSpans:(e.highlight_spans||[]).map((function(e){return{string:e.highlight_str,isHighlighted:!!e.is_highlighted}}))}}))}),e&&n.push({title:y._("People"),suggestions:e.map((function(e){return{id:e.dbx_account_id,initials:e.name.split(/\s+/).map((function(e){return"string"==typeof e[0]?e[0].toUpperCase():""})).join("").substr(0,2),avatar:e.avatar_url,name:e.name,nameHighlights:f.getHighlightSpansForName({name:e.name,query:r})||[],emailAddress:e.email,emailAddressHighlights:f.getHighlightSpansForEmail({email:e.email,query:r})||[],ariaLabel:y._("Search for %(name)s").format({name:e.name})}}))}),n})),t.highlightedSuggestion=s.createSelector(t.suggestions,t.highlightedRow,(function(e,t){if(void 0!==t)for(var r=0,n=0,s=e;n<s.length;n++){var i=s[n];if(void 0!==i.suggestions[t-r])return i.suggestions[t-r];r+=i.suggestions.length}})),t.hasAdditionalPagesToLoad=s.createSelector(t.hasMoreResults,t.loadingDeletedResults,(function(e,t){return e&&!t})),t.selectResultById=function(e,r){return t.resultsList(e).find((function(e){return e instanceof o.File?e.fq_path===r.id:e instanceof o.FileSharedWithMe&&e.file_id===r.id}))}})),define("modules/clean/search/single_page/data/store",["require","exports","modules/clean/react/files_view/data/store","modules/clean/redux/namespaces","modules/clean/redux/store","modules/clean/search/search_bar/data/store","modules/clean/react/extensions/data/store","modules/clean/react/retrieval_success_banner/data/store","modules/clean/search/single_page/data/reducer"],(function(e,t,r,n,s,i,a,o,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForSearch=function(){var e;return c||(c=s.getStoreAndRegisterReducers(((e={})[n.SEARCH_NAMESPACE_KEY]=l.searchReducer,e))),r.getStoreForFilesView(),i.getStoreForSearchBar(),a.getStore(),o.getStoreForSuccessBanner(),c}})),define("modules/clean/search/single_page/filters",["require","exports","tslib","react","react-redux","retrieval-components/file-type-filter","modules/clean/logging/hive/schemas/web-modal-activity","modules/clean/react/folder_dialog/async","modules/clean/react/path_filter_button","modules/clean/search/constants","modules/clean/search/single_page/constants","modules/clean/search/single_page/data/action_creators","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/logger","modules/core/i18n"],(function(e,t,r,n,s,i,a,o,l,c,u,d,p,_,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),d=r.__importStar(d),p=r.__importStar(p);var g=(function(e){function t(t){var n=e.call(this,t)||this;return n.handlePathFilterButtonClick=function(){var e=n.props,t=e.user,r=e.path,s=e.setFilters;t&&o.showFolderDialog({ariaLabel:h._("Folder selector"),canSelectReadonly:!0,initialPath:r,modalName:a.ModalName.SEARCH_FILTER,primaryActionLabel:h._("Select"),title:h._("Select a folder"),user:t,onSuccess:function(e){s({path:e||"/"})}})},n.handleFileTypeFilterChange=function(e){var t=r.__assign({},c.FILE_CATEGORIES_UNCHECKED);e.forEach((function(e){return t[e]="checked"})),n.props.setFilters({fileCategories:t}),_.logFileTypeFiltersChanged(e)},n.handleFileTypeFilterDropdownClicked=function(){n.setState({fileTypeFilterModalOpen:!0})},n.handleFileTypeFilterModalClose=function(){n.setState({fileTypeFilterModalOpen:!1})},n.state={fileTypeFilterModalOpen:!1},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){o.prewarmFolderDialog()},Object.defineProperty(t.prototype,"fileTypeFilterEntries",{get:function(){return this.props.isPaperEnabled?u.FILE_CATEGORIES_PAPER:u.FILE_CATEGORIES_NO_PAPER},enumerable:!0,configurable:!0}),t.prototype.render=function(){return n.default.createElement("div",{className:"search__filters"},n.default.createElement("div",{className:"search__filter search__filter--path"},n.default.createElement(l.PathFilterButton,{path:this.props.path,onClick:this.handlePathFilterButtonClick,defaultText:h._("Any folder"),dropdownClasses:"search__filter-button"})),this.props.searchType!==c.SearchType.IMAGE?n.default.createElement("div",{className:"search__filter search__filter--file-type"},n.default.createElement(i.FileTypeFilterDropdown,{entries:this.fileTypeFilterEntries,className:"search__filter-button",checkedCategories:this.props.fileCategories,onChange:this.handleFileTypeFilterChange,strings:{byType:h._("By type"),selectAll:h._("Select all"),clearAll:h._("Clear all")},onClick:this.props.isScreenWidthMobile?this.handleFileTypeFilterDropdownClicked:void 0}),n.default.createElement(i.FileTypeFilterModal,{modalProps:{title:h._("Filter"),ariaLabel:h._("Filter"),open:this.state.fileTypeFilterModalOpen,onRequestClose:this.handleFileTypeFilterModalClose,shouldFocusAfterRender:!0},entries:this.fileTypeFilterEntries,checkedCategories:this.props.fileCategories,onChange:this.handleFileTypeFilterChange,strings:{byType:h._("By type"),selectAll:h._("Select all"),clearAll:h._("Clear all")}})):null)},t})(n.default.PureComponent);t.SearchFiltersComponent=g;var f={setFilters:d.setFilters};t.SearchFilters=s.connect((function(e){return{user:p.user(e),path:p.path(e),fileCategories:p.fileCategoriesArray(e),searchType:p.searchType(e),isPaperEnabled:p.isPaperEnabled(e),hasFiltersSelected:p.hasFiltersSelected(e)}}),f)(g)})),define("modules/clean/search/single_page/header",["require","exports","tslib","react-redux","react","modules/clean/search/constants","modules/clean/search/single_page/data/selectors/index","modules/core/i18n","modules/clean/search/single_page/reset_filters"],(function(e,t,r,n,s,i,a,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importDefault(s),a=r.__importStar(a),t.SearchHeaderComponent=function(e){var t=e.loadingState,r=e.hasAdditionalPagesToLoad,n=e.numResults;return s.default.createElement("header",{className:"search__header search__header--simplified"},s.default.createElement("h1",null,t===i.SearchLoadingState.LOADING_FIRST_PAGE?o._("Searching..."):r?o.ungettext("%(size)d+ results","%(size)d+ results",n,{comment:'The "+" is meant to indicate that more results are still loading'}).format({size:n}):o.ungettext("%(size)d result","%(size)d results",n).format({size:n})),s.default.createElement(l.ResetFilters,null))};t.SearchHeader=n.connect((function(e){return{loadingState:a.loadingState(e),hasAdditionalPagesToLoad:a.hasAdditionalPagesToLoad(e),numResults:a.results(e).size}}))(t.SearchHeaderComponent)})),define("modules/clean/search/single_page/input/chips",["require","exports","tslib","react","spectrum/button","spectrum/icon_content","spectrum/icon_form","retrieval-components/truncated-string","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar","modules/clean/avatar/size","modules/clean/filepath","modules/core/i18n","modules/core/user_i18n"],(function(e,t,r,n,s,i,a,o,l,c,u,d,p,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),l=r.__importDefault(l),d=r.__importStar(d);var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePathChipCloseClick=function(){t.props.setPath({path:"/",viewport:"chip"})},t.handlePeopleFilterChipCloseClick=function(){var e=t.props.setFilteredAccountId;e&&e({filteredAccountId:void 0})},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.path,r=e.user,s=e.filteredContact;return n.createElement("span",{className:"search-chips"},d.paths_are_equal(t,"/")?null:n.createElement(f,{path:d.filename(t),isTeamMemberFolder:d.paths_are_equal(r&&r.cdm_tmf_path,t),onCloseClick:this.handlePathChipCloseClick}),s?n.createElement(m,{filteredContact:s,onCloseClick:this.handlePeopleFilterChipCloseClick}):null)},t})(n.PureComponent);t.SearchChips=h;var g=function(e){var t=e.label,r=e.icon,i=e.onCloseClick,o=e.ariaLabel;return n.createElement("span",{className:"search-chips__chip"},r,n.createElement("span",{className:"search-chips__chip-text","aria-label":o},t),n.createElement(s.Button,{onClick:i,variant:"styleless","aria-label":p._("Remove filter"),type:"button",tabIndex:-1},n.createElement(a.IconForm,{name:"cancel"})))},f=function(e){var t=e.path,r=e.isTeamMemberFolder,s=e.onCloseClick;return n.createElement(g,{label:n.createElement(o.TruncatedString,{text:t,variant:o.TruncatedStringVariant.TRUNCATED_STRING_END}),icon:n.createElement(i.IconContent,{className:"search-chips__chip-icon","aria-hidden":!0,name:r?"folder_team_member_child-small":"folder-small"}),onCloseClick:s,ariaLabel:p._("Folder filter %(name)s").format({name:t})})},m=function(e){var t=e.filteredContact,r=e.onCloseClick,s=n.createElement(c.InitialsAvatarWithColorDerivedFromName,{alt:p._("User"),dimension:u.AVATAR_DIMENSION_BY_SIZE.XSMALL,name:t.name,initials:_.getInitials(t.name),shape:"CIRCLE"});return n.createElement(g,{label:n.createElement(o.TruncatedString,{text:t.name,variant:o.TruncatedStringVariant.TRUNCATED_STRING_END}),icon:n.createElement(l.default,{alt:p._("User"),dimension:u.AVATAR_DIMENSION_BY_SIZE.XSMALL,photoUrl:t.photo_url,shape:"CIRCLE",defaultAvatar:s}),onCloseClick:r,ariaLabel:p._("Person filter %(name)s").format({name:t.name})})}})),define("modules/clean/search/single_page/input/connected",["require","exports","tslib","react-redux","modules/clean/search/single_page/data/action_creators","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/input/component"],(function(e,t,r,n,s,i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s),i=r.__importStar(i);var l={setQuery:s.setQuery,setPath:s.setPath,clear:s.clear,dismissQuerySuggestions:s.dismissQuerySuggestions,setHighlightedRow:s.setHighlightedRow,setFilteredAccountId:s.setFilteredAccountId,dismissPeopleSuggestions:s.dismissPeopleSuggestions,onSearch:s.performSearch};t.ConnectedSearchInput=n.connect((function(e){return{query:i.query(e),path:i.path(e),querySuggestions:i.querySuggestions(e),highlightedRow:i.highlightedRow(e),filteredContact:i.filteredContact(e),peopleSuggestions:i.peopleSuggestions(e),expSearchSuccessBanner:a.getExpSearchSuccessBanner(e),results:i.resultsList(e)}}),l)(o.SearchInputComponent)})),define("modules/clean/search/single_page/input/suggestions",["require","exports","tslib","react-redux","react","modules/clean/search/single_page/data/action_creators","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/logger","modules/clean/search/types","retrieval-components/search-suggestions","spectrum/dimensions"],(function(e,t,r,n,s,i,a,o,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importDefault(s),i=r.__importStar(i),a=r.__importStar(a),o=r.__importStar(o);var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dismissSuggestions=function(){t.props.dismissQuerySuggestions({query:t.props.normalizedQuery}),t.props.dismissPeopleSuggestions({query:t.props.normalizedQuery}),t.props.setHighlightedRow({index:void 0}),t.props.onFocusInput()},t.handleSuggestionClick=function(e){"query"in e?(o.logQuerySuggestionClicked(t.getIndexOfSuggestion(e),t.props.querySuggestions),t.props.setQuery({query:e.query,alwaysTriggerSearch:!0})):(o.logPeopleFilterClicked(t.getIndexOfSuggestion(e),t.props.peopleSuggestions.length),t.props.setFilteredAccountId({filteredAccountId:e.id}),t.props.setQuery({query:""})),t.dismissSuggestions()},t.handleSuggestonHighlight=function(e){e?t.props.setHighlightedRow({index:t.getIndexOfSuggestion(e)}):t.props.setHighlightedRow({index:void 0})},t.getIndexOfSuggestion=function(e){for(var r=0,n=0,s=t.props.suggestions;n<s.length;n++){for(var i=s[n],a=0;a<=i.suggestions.length;a+=1)if(i.suggestions[a]===e)return a+r;r+=i.suggestions.length}},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.shouldLogQuerySuggestionsShown()&&o.logQuerySuggestionsDisplayed(this.props.querySuggestions),this.shouldLogPeopleSuggestionsShown()&&o.logPeopleFilterShown(this.props.peopleSuggestions.length)},t.prototype.componentDidUpdate=function(e){!this.shouldLogQuerySuggestionsShown()||this.shouldLogQuerySuggestionsShown(e)&&this.props.normalizedQuery===e.normalizedQuery||o.logQuerySuggestionsDisplayed(this.props.querySuggestions),!this.shouldLogPeopleSuggestionsShown()||this.shouldLogPeopleSuggestionsShown(e)&&this.props.normalizedQuery===e.normalizedQuery||o.logPeopleFilterShown(this.props.peopleSuggestions.length)},t.prototype.shouldLogQuerySuggestionsShown=function(e){return void 0===e&&(e=this.props),e.querySuggestionsLoadingState===l.QuerySuggestionsLoadingState.LOADED&&this.shouldShowQuerySuggestions(e)},t.prototype.shouldLogPeopleSuggestionsShown=function(e){return void 0===e&&(e=this.props),e.peopleSuggestionsLoadingState===l.PeopleSuggestionsLoadingState.LOADED&&this.shouldShowPeopleSuggestions(e)},t.prototype.shouldShowQuerySuggestions=function(e){var t=void 0===e?this.props:e,r=t.normalizedQuery,n=t.querySuggestions;return!!r&&!!n&&!!n.length},t.prototype.shouldShowPeopleSuggestions=function(e){var t=void 0===e?this.props:e,r=t.normalizedQuery,n=t.filteredAccountId,s=t.peopleSuggestions;return!(!r||n||!s||!s.length)},t.prototype.render=function(){var e=this,t=this.props,r=t.suggestions,n=t.highlightedSuggestion,i=this.shouldShowQuerySuggestions(),a=this.shouldShowPeopleSuggestions();return i||a?s.default.createElement("div",{className:"search__dropdown"},s.default.createElement(u.Dimensions,null,(function(t){var i=t.width;return i&&s.default.createElement(c.SearchSuggestions,{width:i,suggestions:r,onSuggestionClick:e.handleSuggestionClick,onSuggestionHighlight:e.handleSuggestonHighlight,ariaLabel:"",highlightedSuggestion:n})}))):null},t})(s.default.PureComponent);t.SearchSuggestionsComponent=d;var p={setQuery:i.setQuery,dismissQuerySuggestions:i.dismissQuerySuggestions,setHighlightedRow:i.setHighlightedRow,dismissPeopleSuggestions:i.dismissPeopleSuggestions,setFilteredAccountId:i.setFilteredAccountId};t.ConnectedSearchSuggestions=n.connect((function(e){return{suggestions:a.suggestions(e),highlightedSuggestion:a.highlightedSuggestion(e),querySuggestions:a.querySuggestions(e),normalizedQuery:a.normalizedQuery(e),user:a.user(e),querySuggestionsLoadingState:a.querySuggestionsLoadingState(e),peopleSuggestionsLoadingState:a.peopleSuggestionsLoadingState(e),filteredAccountId:a.filteredAccountId(e),peopleSuggestions:a.peopleSuggestions(e)}}),p)(d)})),define("modules/clean/search/single_page/logger",["require","exports","tslib","modules/clean/filepath","modules/clean/logging/hive/schemas/search-web_search_activity","modules/clean/logging/telemetry","modules/clean/react/browse/models","modules/clean/search/constants","modules/clean/search/logger","modules/clean/web_user_action_events","modules/clean/search/single_page/data/store","modules/clean/search/single_page/data/selectors/index"],(function(e,t,r,n,s,i,a,o,l,c,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),d=r.__importStar(d),t.hiveLogger=new i.HiveLogger;var p=function(){return d.commonLogFields(u.getStoreForSearch().getState())},_=function(e){return e!==o.SearchOriginPathway.WEB?{pathway:e}:void 0};t.logQueryStarted=function(e){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_started"},p()),{start:0,result_count:void 0,extra:_(e)})))},t.logQueryCompleted=function(e){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_completed"},p()),{latency:e})))},t.logQueryFailed=function(e,n,i){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_failed"},p()),{latency:e,failure_type:n,extra:_(i)})))},t.logResultAction=function(e,n,i,a,o,l){var c=r.__assign(r.__assign(r.__assign({event_name:"result_action"},p()),t.logFieldsFromResult(i)),{action_type:e,position:n.indexOf(i),action_source:o});c.extra=r.__assign(r.__assign({},l),c.extra),a&&(c.extra=r.__assign(r.__assign({},c.extra),{action_surface:a})),t.hiveLogger.log(new s.SearchWebSearchActivityRow(c))},t.logHistoryDisplayed=function(e){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"recent_history_displayed"},p()),{recent_history_map:e.map((function(e){return e.rawQuery})).reduce((function(e,t,r){return e[r]=t,e}),{})})))},t.logHistoryAdded=function(e){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"recent_query_stored"},p()),{position:e})))},t.logHistoryClicked=function(e,n){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"recent_query_selected"},p()),{query_string:e,position:n})))},t.logHistoryCleared=function(){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign({event_name:"recent_history_cleared"},p())))},t.logScopeChipChanged=function(e,n){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"scope_chip_changed"},p()),{file_path:e,viewport:n})))},t.logSwitchSearchType=function(e,n,i){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"switch_search_type"},p()),{request_id:e,extra:{search_type:n,ref:i}})))},t.logImageSearchPromptShown=function(e,n){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"image_search_prompt_shown"},p()),{request_id:e,extra:{type:n}})))},t.logDwellTime=function(e,n){var i=d.resultQuery(u.getStoreForSearch().getState());t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"dwell_time"},p()),{query_string:i,view_type:n,extra:{dwell_time:e.toString()}})))},t.logFileTypeFiltersChanged=function(e){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"file_type_filter_changed"},p()),{file_type_filters:e})))},t.logFiltersReset=function(){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign({event_name:"filters_reset"},p())))},t.logSpellCorrectionShown=function(e){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"spell_correct_shown"},p()),{request_id:e.requestId,extra:{is_corrected:e.isCorrected.toString()}})))},t.logSpellCorrectionClicked=function(e){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"spell_correct_clicked"},p()),{request_id:e.requestId,extra:{is_corrected:e.isCorrected.toString()}})))},t.logQuerySuggestionsDisplayed=function(e){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_suggestions_displayed"},p()),{result_count:e.length,query_suggestion_strings:e.map((function(e){return e.text?e.text:""}))})))},t.logQuerySuggestionClicked=function(e,n){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_suggestions_clicked"},p()),{position:e,result_count:n.length,query_suggestion_strings:n.map((function(e){return e.text?e.text:""}))})))},t.logQuerySuggestionsDismissed=function(e){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_suggestions_dismissed"},p()),{query_string:e})))},t.logQuerySuggestionsFetched=function(e,n,i){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_suggestions_fetched"},p()),{query_string:e,result_count:n,latency:i})))},t.logQuerySuggestionsFailed=function(e){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_suggestions_failed"},p()),{query_string:e})))},t.logFieldsFromResult=function(e){return e instanceof a.File?{deleted:e.isDeleted,file_extension:n.file_extension_for_logging(e.fq_path),file_last_edited:e.ts,file_name:n.filename(e.fq_path),file_nsid:""+e.ns_id,file_size:e.bytes,file_sjid:""+e.sjid,match_type:e.match_type,result_id:e.ns_id+":"+e.sjid}:e instanceof a.Paper?{paper_pad_id:e.pad_id,result_id:e.pad_id}:e instanceof a.PaperFolder?{paper_folder_id:e.folder_id,result_id:e.folder_id}:e instanceof a.FileSharedWithMe?{deleted:!1,file_extension:n.file_extension_for_logging(e.filename),file_last_edited:e.ts,file_name:n.filename(e.filename),file_size:e.bytes,match_type:e.match_type,result_id:e.file_id,extra:{result_type:e.is_cloud_doc?l.SearchLogResultType.SHARED_CLOUD_DOC:l.SearchLogResultType.SHARED_DOC}}:{}},t.logSortOrderChanged=function(e){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"sort_results"},p()),{extra:{sort_field:e.sortField,sort_direction:e.sortDirection}})))},t.logPeopleFilterResponse=function(e){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"people_filter_response"},p()),{result_count:e})))},t.logPeopleFilterShown=function(e){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"people_filter_shown"},p()),{result_count:e})))},t.logPeopleFilterClicked=function(e,n){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"people_filter_clicked"},p()),{position:e,result_count:n})))},t.logPeopleFilterRemoved=function(){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign({event_name:"people_filter_removed"},p())))},t.logContextMenuClick=function(){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign({event_name:"context_menu_click"},p())))},t.logSearchBoxFocus=function(){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign({event_name:"search_box_focus"},p())))},t.logQueryTyped=function(e){t.hiveLogger.log(new s.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_typed"},p()),{query_string:e})))},t.logNavigateToResult=function(e,r,n,s){var i=r instanceof a.Paper||r instanceof a.PaperFolder?c.WebUserActionLogEvent.PAPER_OPEN:c.WebUserActionLogEvent.FILE_VIEW;t.logResultAction(i,e,r,n,s)}})),define("modules/clean/search/single_page/preview",["require","exports","tslib","react-redux","react","modules/clean/react/browse/constants","modules/clean/search/single_page/data/action_creators","modules/clean/search/single_page/data/selectors/index","modules/constants/python"],(function(e,t,r,n,s,i,a,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importDefault(s),a=r.__importStar(a),o=r.__importStar(o);var c=(function(t){function n(){var s=null!==t&&t.apply(this,arguments)||this;return s.closeFileViewer=function(){new Promise((function(t,r){e(["modules/clean/react/file_viewer/controller"],t,r)})).then(r.__importStar).then((function(e){e.close()}))},s.handleFlipNext=function(){var e=s.props,t=e.previewFile,r=e.previewableFiles,n=e.setPreviewFileId;if(t&&!(r.length<2)){var i=r.indexOf(t);i<0||((i+=1)>=r.length&&(i=0),n({previewFileId:r[i].file_id}))}},s.handleFlipPrevious=function(){var e=s.props,t=e.previewFile,r=e.previewableFiles,n=e.setPreviewFileId;if(t&&!(r.length<2)){var i=r.indexOf(t);i<0||((i-=1)<0&&(i=r.length-1),n({previewFileId:r[i].file_id}))}},s.showFileViewer=function(){var t=s.props,i=t.user,a=t.previewableFiles,o=t.setPreviewFileId,c=t.previewFile;i&&c&&new Promise((function(t,r){e(["modules/clean/react/file_viewer/controller"],t,r)})).then(r.__importStar).then((function(e){e.open(a,a.indexOf(c),i,n.containerId,{fileViewAction:l.FileViewActionType.CLICK,fileViewOrigin:l.FileViewOriginType.SEARCH,fileViewTarget:l.FileViewTargetType.PRIVATE,skipOuterRouting:!0,disableRouting:!0,disableFlipping:!1,onCloseViewer:function(){o({previewFileId:void 0})},onFlipNext:s.handleFlipNext,onFlipPrevious:s.handleFlipPrevious})}))},s}return r.__extends(n,t),n.prototype.componentDidMount=function(){this.showFileViewer()},n.prototype.componentDidUpdate=function(e){!e.previewFile||this.props.previewFile?e.previewFile||!this.props.previewFile?e.previewFile&&this.props.previewFile&&this.props.previewFile.file_id!==e.previewFile.file_id&&this.showFileViewer():this.showFileViewer():this.closeFileViewer()},Object.defineProperty(n,"containerId",{get:function(){return document.getElementById("react-file-viewer")?"react-file-viewer":i.BROWSE_FILE_VIEWER_ELEMENT_ID},enumerable:!0,configurable:!0}),n.prototype.render=function(){return null},n})(s.default.PureComponent);t.SearchPreviewComponent=c;var u={setPreviewFileId:a.setPreviewFile};t.SearchPreview=n.connect((function(e){return{user:o.user(e),previewFile:o.previewFile(e),previewableFiles:o.previewableFiles(e)}}),u)(c)})),define("modules/clean/search/single_page/sidebar",["require","exports","tslib","react-redux","react","modules/clean/filepath","modules/clean/react/browse/models","modules/clean/react/css","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/types","modules/clean/search/search_helpers","modules/clean/search/search_results/sidebar_view","modules/clean/search/single_page/data/action_creators","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/data/store","modules/clean/search/single_page/image_panel","modules/clean/search/single_page/logger","modules/core/browser","modules/core/i18n","modules/core/notify"],(function(e,t,r,n,s,i,a,o,l,c,u,d,p,_,h,g,f,m,S,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importDefault(s),i=r.__importStar(i),l=r.__importStar(l),p=r.__importStar(p),_=r.__importStar(_),h=r.__importStar(h),S=r.__importStar(S);var E=(function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.starredStoreRemoveListener=function(){},e.handleSearchFiltersChanged=function(t){var r=t.path,n=t.fileCategories,s=t.searchType;if(void 0===r||i.paths_are_equal(r,e.props.path)||e.props.setPath({path:r,viewport:"sidebar"}),n&&u.fileCategoriesToString(n)!==u.fileCategoriesToString(e.props.fileCategories)){e.props.setFileCategories({fileCategories:n});var a=Object.keys(n).filter((function(e){return"checked"===n[e]}));m.logFileTypeFiltersChanged(a)}s&&e.props.setSearchType({searchType:s})},e.handleDelete=function(t){var r=e.props,n=r.deleteFiles,s=r.purgeFiles,i=r.user,o=r.context,l=t.some(a.File.isTeamSharedFolder),c=t.some((function(e){return e.read_only})),u=t.every((function(e){return e.isDeleted}));!e.props.context.isCurrentPathWriteable()||l||c?l?v.Notify.error(y._("Team folders canâ€™t be deleted.")):v.Notify.warning(y._("You donâ€™t have permission to delete files in this folder.")):u?s({files:t,user:i,context:o}):n({files:t,user:i,context:o})},e.handlePermanentDelete=function(t){var r=e.props;(0,r.purgeFiles)({files:t,user:r.user,context:r.context})},e.handleRestore=function(t){var r=e.props;(0,r.restoreFiles)({files:t,user:r.user,context:r.context})},e.handlePreview=function(t){e.props.setPreviewFile({previewFileId:t.file_id})},e.handleContextMenuClick=function(){m.logContextMenuClick()},e}return r.__extends(n,t),n.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,n=this;return r.__generator(this,(function(s){switch(s.label){case 0:return this.props.handleComponentTTI({component:"sidebar",query:this.props.resultQuery}),[4,new Promise((function(t,r){e(["modules/clean/react/starred/store"],t,r)})).then(r.__importStar)];case 1:return t=s.sent().StarredStore,this.starredStoreRemoveListener=t.addListener((function(){n.setState({starredState:t.getLoadingStates()})})),[2]}}))}))},n.prototype.componentWillUnmount=function(){this.starredStoreRemoveListener()},n.prototype.componentDidUpdate=function(){this.props.handleComponentTTI({component:"sidebar",query:this.props.resultQuery})},n.prototype.render=function(){var e=this,t=this.props,r=t.responsive,n=t.resultQuery,i=t.selectedFiles,o=t.searchType,l=t.shouldShowImagePanel,u=t.filteredAccountId,p=t.scrollableSidebarRef;if(!n&&!u)return s.default.createElement("div",{className:"search__sidebar"});var _=l?s.default.createElement(f.ImagePanelView,{selectedFiles:i,responsive:r,searchType:o,onSearchFiltersChanged:this.handleSearchFiltersChanged,imageSuggestionQuery:this.props.imageSuggestionQuery,imageSuggestionResults:this.props.imageSuggestionResults,imageSuggestionRequestId:this.props.imageSuggestionRequestId}):null;return s.default.createElement("div",{id:"brws-sidebar-view",className:"search__sidebar"},_,s.default.createElement(d.SearchResultsSidebarView,{actionHandlers:{onDelete:this.handleDelete,onPermanentDelete:this.handlePermanentDelete,onRestore:this.handleRestore,onShowComment:function(t){t instanceof a.FileSharedWithMe?S.redirect(t.href):e.handlePreview(t)},onShowRename:function(t){e.props.setFileRename({file:t,renameState:c.RenameState.PENDING_INPUT})}},responsive:r,onSearchFiltersChanged:this.handleSearchFiltersChanged,onContextMenuClick:this.handleContextMenuClick,scrollableSidebarRef:p}))},n})(s.default.PureComponent);t.SearchSidebarComponent=E;var w=g.getStoreForSearch(),T={setPath:p.setPath,setFileCategories:p.setFileCategories,setSearchType:p.setSearchType,handleComponentTTI:p.handleComponentTTI,setPreviewFile:p.setPreviewFile,setFileRename:l.setFileRename,deleteFiles:p.deleteFiles,purgeFiles:p.purgeFiles,restoreFiles:p.restoreFiles},C=n.connect((function(e){return{resultQuery:h.resultQuery(e),path:h.path(e),selectedFiles:h.selectedFiles(e),fileCategories:h.fileCategories(e),isNautilusEnabled:h.isNautilusEnabled(e),isPaperEnabled:h.isPaperEnabled(e),searchType:h.searchType(e),imageSuggestionCount:h.imageSuggestionCount(e),imageSuggestionQuery:h.imageSuggestionQuery(e),imageSuggestionResults:h.imageSuggestionResults(e),imageSuggestionRequestId:h.imageSuggestionRequestId(e),experiments:_.experiments(e),context:h.context(e),shouldShowImagePanel:!!_.shouldShowImagePanel(e),filteredAccountId:h.filteredAccountId(e)}}),T)(E);t.SearchSidebar=o.requireCssWithComponent((function(e){return s.default.createElement(n.Provider,{store:w},s.default.createElement(C,r.__assign({},e)))}),["/static/css/search/search_results-vflMAMrNK.css"])})),define("modules/clean/search/single_page/tabs",["require","exports","tslib","react-redux","react","spectrum/tabbed_header","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/logger","modules/clean/search/types"],(function(e,t,r,n,s,i,a,o,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importDefault(s),a=r.__importStar(a),o=r.__importStar(o),l=r.__importStar(l);var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._tryLogImageSearchPromptShown=function(){var e=t.props,r=e.searchResultsExperiments,n=e.imageSuggestionCount,s=e.imageSuggestionRequestId;r.expImageContentSearchDiscovery===c.ImageSearchDiscoveryVariants.TAB&&n>0&&l.logImageSearchPromptShown(s||"","tab")},t}return r.__extends(t,e),t.prototype.componentDidUpdate=function(e){e.imageSuggestionRequestId!==this.props.imageSuggestionRequestId&&this._tryLogImageSearchPromptShown()},t.prototype.componentDidMount=function(){this._tryLogImageSearchPromptShown()},t.prototype.render=function(){var e=this.props,t=e.onSwitchTab,r=e.searchType,n=e.tabs;return n&&n.length?s.default.createElement(i.TabbedHeader,{activeTabId:r,onSelection:t,className:"search__tabs"},n.map((function(e){var n=e.id,a=e.label;return s.default.createElement(i.Tab,{id:n,key:n,active:n===r,onClick:function(){return t(n,"tab")},className:"search__tab"},s.default.createElement("span",{className:"search__tab--contents"},a))}))):null},t})(s.default.PureComponent);t.SearchTabsComponent=u;t.SearchTabs=n.connect((function(e){return{searchType:o.searchType(e),tabs:a.tabs(e),searchResultsExperiments:a.searchResultsExperiments(e),imageSuggestionCount:o.imageSuggestionCount(e),imageSuggestionRequestId:o.imageSuggestionRequestId(e)}}),{})(u)})),define("modules/clean/search/single_page/utils",["require","exports","tslib","modules/clean/browse_uri_interface","modules/clean/react/browse/models","modules/clean/search/single_page/constants","modules/clean/search/store_helpers","modules/core/browser"],(function(e,t,r,n,s,i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a),t.generateRandomId=a.generateRandomId,t.getIdForSearchResult=function(e){return e instanceof s.File?e.file_id||e.fq_path:e instanceof s.Paper?e.pad_id:e instanceof s.PaperFolder?e.folder_id:e instanceof s.FileSharedWithMe?e.file_id:""},t.responsiveHeaderHeight=function(e,t,r){var n=r?48:0;return e.isMatchedLarge?i.SEARCH_PAGE_HEADER_HEIGHT_DESKTOP-(t?20:0)+n:e.isMatchedMedium?i.SEARCH_PAGE_HEADER_HEIGHT_TABLET+n:i.SEARCH_PAGE_HEADER_HEIGHT_MOBILE+n},t.getEscapedSearchQuery=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},t.getHighlightSpansForName=function(e){var r=e.name,n=e.query;if(n){for(var s,i=t.getEscapedSearchQuery(n),a=new RegExp("(^"+i+")|(\\s"+i+")","gi"),o=[];null!==(s=a.exec(r));)o.push({start:s.index,end:s.index+s[0].length});if(0!==o.length){for(var l=[],c=0;c<r.length&&o.length>0;){var u=o.shift();c<u.start&&l.push({string:r.substring(c,u.start),isHighlighted:!1}),l.push({string:r.substring(u.start,u.end),isHighlighted:!0}),c=u.end}return c<r.length&&l.push({string:r.substring(c),isHighlighted:!1}),l}}},t.getHighlightSpansForEmail=function(e){var r=e.email,n=e.query;if(r&&n){var s=t.getEscapedSearchQuery(n),i=r.indexOf(s);if(-1!==i){var a=[];return i>0&&a.push({string:r.substring(0,i),isHighlighted:!1}),a.push({string:r.substring(i,i+s.length),isHighlighted:!0}),i+s.length<r.length&&a.push({string:r.substring(i+s.length),isHighlighted:!1}),a}}},t.navigateToResult=function(e,t,r){e instanceof s.File&&o.redirect(n.href_for_file(t,e)),(e instanceof s.Paper||e instanceof s.PaperFolder)&&o.redirect(e.url),e instanceof s.FileSharedWithMe&&o.redirect(e.href)}})),define("modules/clean/search/single_page/view",["require","exports","tslib","classnames","external/lodash","immutable","react","react-redux","modules/clean/browse_uri_interface","modules/clean/cloud_docs/open_with_utils","modules/clean/cloud_docs/preferred_editor_utils","modules/clean/cloud_docs/types","modules/clean/filepath","modules/clean/react/async/loadable","modules/clean/react/browse/models","modules/clean/react/css","modules/clean/react/extensions/data/selectors","modules/clean/react/file_viewer/async_controller","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/image","modules/clean/react/retrieval_success_banner/constants","modules/clean/react/retrieval_success_banner/retrieval_success_browseview_banner","modules/clean/react/retrieval_success_banner/util","modules/clean/search/constants","modules/clean/search/search_results/view","modules/clean/search/single_page/data/action_creators","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/data/store","modules/clean/search/single_page/filters","modules/clean/search/single_page/header","modules/clean/search/single_page/logger","modules/clean/search/single_page/navigation","modules/clean/search/single_page/preview","modules/clean/search/single_page/spell_correction","modules/clean/search/single_page/tabs","modules/clean/search/single_page/utils","modules/clean/search/single_page/zero_query/index","modules/clean/sharing/browse_exports","modules/clean/static_urls","modules/clean/upsell/top_notification_listener","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/constants/python","modules/core/browser","modules/core/browser_detection","modules/core/i18n","modules/core/notify","modules/core/uri"],(function(e,t,r,n,s,i,a,o,l,c,u,d,p,_,h,g,f,m,S,y,v,E,w,T,C,F,R,A,I,b,P,L,x,O,D,N,q,Q,M,H,k,U,W,V,G,B,z,Y,j,K,Z,J,X){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importStar(s),i=r.__importStar(i),a=r.__importDefault(a),p=r.__importStar(p),f=r.__importStar(f),y=r.__importStar(y),v=r.__importStar(v),b=r.__importStar(b),P=r.__importStar(P),L=r.__importStar(L),N=r.__importStar(N),j=r.__importStar(j);var $=(function(o){function _(e){var t=o.call(this,e)||this;return t.state={hasTopNotification:!1},t.starredStoreListenerUnsubscribe=function(){},t.scrollContainer=a.default.createRef(),t.canUseSticky=ae(),t.handlePreview=function(e){t.props.setPreviewFile({previewFileId:e.file_id})},t.handleDelete=function(e){var r=t.props,n=r.deleteFiles,s=r.purgeFiles,i=r.user,a=r.context,o=e.some(h.File.isTeamSharedFolder),l=e.some((function(e){return e.read_only})),c=e.every((function(e){return e.isDeleted}));!t.props.context.isCurrentPathWriteable()||o||l?o?J.Notify.error(Z._("Team folders canâ€™t be deleted.")):J.Notify.warning(Z._("You donâ€™t have permission to delete files in this folder.")):c?s({files:e,user:i,context:a}):n({files:e,user:i,context:a})},t.handlePermanentDelete=function(e){var r=t.props;(0,r.purgeFiles)({files:e,user:r.user,context:r.context})},t.handleRestore=function(e){var r=t.props;(0,r.restoreFiles)({files:e,user:r.user,context:r.context})},t.actionHandlers={onDelete:t.handleDelete,onShowRename:function(e){t.props.setFileRename({file:e,renameState:E.RenameState.PENDING_INPUT})},onShowComment:function(e){e instanceof h.FileSharedWithMe?j.redirect(e.href):t.handlePreview(e)},onRestore:t.handleRestore,onPermanentDelete:t.handlePermanentDelete},t.handleGetOverflowMenuActions=function(e,r,n,s,a){var o=t.state.fileActionsModule,l=t.props,c=l.user,u=l.context,d=l.viewType,p=l.extensionsFeatureFlags,_=l.sharingServiceInfo,h=l.browseExperiments,g=l.searchBarExperiments;if(!o)return[];var f=o.getActionsForFileCollection({files:i.Set([e]),context:u,user:c,viewType:d,extensionsFeatureFlags:p,sharingServiceInfo:_,actionHandlers:t.actionHandlers,isQueryingFolderSizes:!1,skipSharing:!1,isSearchMode:!0,canShowUJPopup:s,isSidebar:a,responsive:n,isOverFreeQuota:!1,hasExcludedNsIds:!1,canDisplayFolderSizes:r,useSearchSuccessBanner:!!g.expSearchSuccessBanner,expFolderHistoryRollbacks:!!h.folderHistoryRollbacks}),m=new Array;return f.forEach((function(e){"function"!=typeof e&&m.push(e)})),[m]},t.handleRenderSharedWithController=function(){return null},t.handleGetIsFileJumping=function(){return!1},t.handleIsFileViewerShown=function(){return!!t.props.previewFile},t.handleShowShare=function(e,r){N.logResultAction(z.WebUserActionLogEvent.SHARE,t.props.results,e),W.asyncShowShareModal(t.props.user,e,{browseContext:t.props.context,origin:r})},t.handleSwitchViewType=function(e){t.props.setViewType({viewType:e,user:t.props.user}),window.setTimeout((function(){var e=document.querySelector(".brws-view-type-column-header-menu-trigger");e&&e.focus()}),0)},t.filesViewActionHandlers={onDelete:s.noop,onShowRename:function(e){t.props.setFileRename({file:e,renameState:E.RenameState.PENDING_INPUT})},onCopyToClipboard:s.noop,onPasteFromClipboard:s.noop,onNewFolderSubmit:s.noop,onNewFolderCancel:s.noop,onRenameSubmit:function(e,r){t.props.renameFile({file:e,name:r,checkFSWs:!0})},onRenameCancel:function(e){return t.props.setFileRename({file:e,renameState:null})},onSwitchViewType:t.handleSwitchViewType,onColumnsChanged:s.noop,onCanDisplayFolderSizesChanged:s.noop,onAddFileJumpKeyCode:s.noop,onResetFileJump:s.noop,onShowShare:t.handleShowShare,onPresentInZoom:function(e){m.asyncOpenPreview({containerId:Q.SearchPreviewComponent.containerId,files:[e],indexOfPreviewFile:0,shouldFocusComment:!1,user:t.props.user,onFileViewerDidMount:function(){},onFileViewerUnmount:function(){},fileViewAction:Y.FileViewActionType.CLICK,fileViewOrigin:Y.FileViewOriginType.SEARCH,fileViewTarget:Y.FileViewTargetType.PRIVATE,shouldPresentInZoom:!0})}},t.getPageHeaderHeight=function(){var e=t.props.shouldRenderInlineSearchFilters,r=0;return t.canUseSticky&&(r+=33,e&&(r+=48),t.props.shouldRenderTabs&&(r+=44)),r-1},t.updateViewTypeScope=function(e){t.props.setViewTypeScope({viewTypeScope:e===A.SearchType.IMAGE?S.VIEW_TYPE_SCOPE_IMAGE_SEARCH:S.VIEW_TYPE_GLOBAL_SCOPE}),e===A.SearchType.IMAGE&&t.props.viewType!==E.ViewType.LargeGrid&&t.props.setViewType({user:t.props.user,viewType:E.ViewType.LargeGrid})},t.handleSelectionChange=function(e,r){t.props.setSelection({selection:e,actionSource:r})},t.handleNavigateToFileOrFolder=function(e,r){void 0===r&&(r={});var n=r.actionSource;if(t.addHistory(),t.props.stopAndLogDwellTime(),e.isDeleted)t.handleRestore([e]);else{if(e.is_dir)return N.logResultAction(z.WebUserActionLogEvent.FOLDER_OPEN,t.props.results,e,void 0,n),void q.searchNavigationManager.set(l.href_for_file(t.props.user,e));N.logResultAction(z.WebUserActionLogEvent.FILE_VIEW,t.props.results,e,void 0,n),e.is_cloud_doc?c.openCloudDoc(e,t.props.user,d.WebSearchSource):u.hasPreferredEditorSupport(e)?u.openInPreferredEditor(t.props.user,e,t.props.preferredEditors,(function(){t.handlePreviewFile(e)}),{fileViewAction:Y.FileViewActionType.CLICK,fileViewOrigin:Y.FileViewOriginType.SEARCH}):t.handlePreviewFile(e)}},t.handlePreviewFile=function(e){t.props.setPreviewFile({previewFileId:e.file_id})},t.addHistory=function(){t.props.addHistory()},t.handleSearch=function(e,r,n){void 0===r||p.paths_are_equal(r,t.props.path)||t.props.setPath({path:r}),e!==t.props.normalizedQuery&&t.props.setQuery({query:e,alwaysTriggerSearch:!0})},t.handleLocationLinkClick=function(e,r){N.logResultAction(z.WebUserActionLogEvent.CLICK_PATH_LINK,t.props.results,e),r||q.searchNavigationManager.set(l.get_browse_root(t.props.user)+X.URI.encode_parts(p.parent_dir(e.fq_path)))},t.handleOpenPaper=function(e){N.logResultAction(z.WebUserActionLogEvent.PAPER_OPEN,t.props.results,e),j.redirect(e.url)},t.handleFileSharedWithMe=function(e){N.logResultAction(z.WebUserActionLogEvent.FILE_VIEW,t.props.results,e),j.redirect(e.href)},t.handleSwitchTab=function(e,r){if(e!==t.props.searchType){var n=t.props,s=n.imageSuggestionRequestId,i=n.requestId;N.logSwitchSearchType((e===A.SearchType.IMAGE?s:i)||"",e,r||"tab"),t.props.setFilters({searchType:e})}},t.handleRangeInView=function(e,r){t.props.loadingState===A.SearchLoadingState.LOADED&&t.props.hasMoreResults&&r===t.props.results.size-(t.props.viewType===E.ViewType.List?1:0)&&t.props.fetchNextPage()},t.handleSortOrderChanged=function(e,r){t.props.setSortOrder({sortOrder:{sortField:e,sortDirection:r}})},t.handleFocusSearchBar=function(){t.props.inputBox.current&&t.props.inputBox.current.focus()},t.handleStarClick=function(e,r){N.logResultAction(r?z.WebUserActionLogEvent.STAR:z.WebUserActionLogEvent.REMOVE_STAR,t.props.results,e),t.props.searchBarExperiments.expSearchSuccessBanner&&R.setSearchSuccessBannerVisible()},t.onContainerClick=function(e){w.shouldClickDeselect(e)&&t.props.clearSelection({actionSource:z.ActionSourceValue.WHITESPACE})},e.loadViewTypes({user:e.user}),e.loadHistory(),t}return r.__extends(_,o),_.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,n,s,i=this;return r.__generator(this,(function(a){switch(a.label){case 0:return this.props.handleComponentTTI({component:"view",query:this.props.resultQuery}),[4,B.waitForTTI()];case 1:return a.sent(),[4,Promise.all([new Promise((function(t,r){e(["modules/clean/react/browse/file_actions/file_actions"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/starred/browse_exports"],t,r)})).then(r.__importStar)])];case 2:return t=a.sent(),n=t[0],s=t[1].StarredStore,this.starredStoreListenerUnsubscribe=s.addListener((function(){i.setState({starredState:s.getLoadingStates()})})),this.setState({fileActionsModule:n}),[2]}}))}))},_.prototype.componentWillMount=function(){var e=this;this.updateViewTypeScope(this.props.searchType),window.addEventListener("beforeunload",this.props.stopAndLogDwellTime),this.topNotificationListener=G.createTopNotificationListener((function(t){e.setState({hasTopNotification:t})}))},_.prototype.componentDidUpdate=function(e){this.props.handleComponentTTI({component:"view",query:this.props.resultQuery}),e.searchType!==this.props.searchType&&this.updateViewTypeScope(this.props.searchType)},_.prototype.componentWillUnmount=function(){window.removeEventListener("beforeunload",this.props.stopAndLogDwellTime),this.starredStoreListenerUnsubscribe(),this.props.stopAndLogDwellTime(),this.topNotificationListener.unsubscribe()},_.prototype.render=function(){var e=this.props,r=e.user,i=e.responsive,o=e.results,c=e.context,u=e.loadingState,d=e.resultQuery,p=e.path,_=e.searchSessionId,h=e.viewType,g=e.selection,f=e.selectedFiles,m=e.searchType,S=e.filteredContactName,y=e.searchBarExperiments,v=e.inputBox,E=e.shouldRenderInlineSearchFilters,w=this.state.hasTopNotification;if(u===A.SearchLoadingState.LOAD_ERROR)return a.default.createElement(t.AsyncErrorComponent,null);if(u===A.SearchLoadingState.ZERO_QUERY)return a.default.createElement(U.ZeroQueryView,{inputBox:v});var T=!!this.props.resultQuery&&this.props.results.isEmpty()&&this.props.loadingState===A.SearchLoadingState.LOADED,R=n.default("search__view","maestro-content-scroll",{"maestro-content-scroll_scroll-disabled":u===A.SearchLoadingState.LOADING_FIRST_PAGE}),b=a.default.createElement(F.RetrievalSuccessBrowseviewBanner,{user:r,displayContext:C.SearchSuccessDisplayContext.IN_USPS,expSearchSuccessBanner:!!y.expSearchSuccessBanner,isFilePreview:!1,isSearchMode:!0,inUniversalSinglePageSearch:!0}),P=a.default.createElement(H.SearchTabs,{onSwitchTab:this.handleSwitchTab}),L=E&&a.default.createElement(O.SearchFilters,{isScreenWidthMobile:!(this.props.responsive.isMatchedLarge||this.props.responsive.isMatchedMedium)});return a.default.createElement(a.default.Fragment,null,a.default.createElement(Q.SearchPreview,null),a.default.createElement("div",{className:R,ref:this.scrollContainer,onClick:this.onContainerClick},a.default.createElement("div",null,b,a.default.createElement(ie,{responsive:i,offset:0,contentScroll:!0,simplifiedLockup:!0,hasTopNotification:w},P,a.default.createElement(D.SearchHeader,null),a.default.createElement(M.SearchSpellCorrection,null),L),T?a.default.createElement(ne,{hasFiltersSelected:this.props.hasFiltersSelected,resetFiltersUrl:this.props.searchUrlReset,onResetFilters:this.props.resetFilters}):a.default.createElement(I.SearchResultsView,{filesViewActionHandlers:this.filesViewActionHandlers,searchResultsExperiments:this.props.searchResultsExperiments,searchBarExperiments:this.props.searchBarExperiments,browseExperiments:this.props.browseExperiments,maestroSearchBarProps:{},onFocusSearchBar:this.handleFocusSearchBar,onSearch:this.handleSearch,onScroll:s.noop,setFileUploaderPath:s.noop,onSelectionChange:this.handleSelectionChange,path:p,user:r,handleComponentTTI:s.noop,ensureFileViewerClosedIfNotPreviewing:s.noop,getIsFileJumping:this.handleGetIsFileJumping,isFileViewerShown:this.handleIsFileViewerShown,fileRename:this.props.fileRename,arePostTTIModulesLoaded:!!this.state.fileActionsModule,getOverflowMenuActions:this.handleGetOverflowMenuActions,onLocationLinkClick:this.handleLocationLinkClick,onNavigateToFileOrFolder:this.handleNavigateToFileOrFolder,onNavigateToParentFolder:s.noop,onOpenFileSharedWithMe:this.handleFileSharedWithMe,onOpenPaper:this.handleOpenPaper,context:c,hasMoreResults:!!this.props.hasMoreResults,loadingState:u,latestQuery:d,queryForResultsTitle:d,searchSessionId:_,searchResults:o,selection:g,selectedFiles:f,viewType:h,renderSharedWithController:this.handleRenderSharedWithController,hrefForFile:l.href_for_file,responsive:i,onSearchFiltersChanged:this.props.setFilters,starredState:this.state.starredState,fileCategories:this.props.fileCategories,pageHeaderHeight:this.getPageHeaderHeight(),onSortChange:this.handleSortOrderChanged,searchType:m,extensionsFeatureFlags:this.props.extensionsFeatureFlags,sharingServiceInfo:this.props.sharingServiceInfo,onRangeInView:this.handleRangeInView,currentSort:this.props.sortOrder,onStarClick:this.handleStarClick,scrollContainer:this.scrollContainer,filteredContactName:S}))))},_})(a.default.PureComponent);t.SearchViewComponent=$;var ee=x.getStoreForSearch(),te={setPath:b.setPath,setQuery:b.setQuery,setFileCategories:b.setFileCategories,setViewType:y.setViewType,setViewTypeScope:y.setViewTypeScope,loadViewTypes:y.loadViewTypes,setSelection:b.setSelection,clearSelection:b.clearSelection,clearHistory:b.clearAllHistory,loadHistory:b.loadHistory,addHistory:b.addQueryToHistory,setPreviewFile:b.setPreviewFile,setFileRename:y.setFileRename,handleComponentTTI:b.handleComponentTTI,fetchNextPage:b.fetchNextPage,setSearchType:b.setSearchType,renameFile:b.renameFile,deleteFiles:b.deleteFiles,purgeFiles:b.purgeFiles,setSortOrder:b.setSortOrder,updateResults:b.updateResults,restoreFiles:b.restoreFiles,setFilteredAccountId:b.setFilteredAccountId,setFilters:b.setFilters,resetFilters:b.resetFilters,stopAndLogDwellTime:b.stopAndLogDwellTime},re=o.connect((function(e){return{normalizedQuery:L.normalizedQuery(e),resultQuery:L.resultQuery(e),loadingState:L.loadingState(e),results:L.resultsList(e),path:L.path(e),searchSessionId:L.sessionId(e),requestId:L.requestId(e),viewType:v.viewType(e),selectedFiles:L.selectedFiles(e),selection:L.selection(e),history:L.queryHistory(e),previewFile:L.previewFile(e),extensionsFeatureFlags:f.getFeatureFlags(e),sharingServiceInfo:f.sharingServiceInfo(e),fileCategories:L.fileCategories(e),context:L.context(e),fileRename:v.fileRename(e),hasMoreResults:L.hasMoreResults(e),searchType:L.searchType(e),imageSuggestionRequestId:L.imageSuggestionRequestId(e),sortOrder:L.sortOrder(e),searchResultsExperiments:P.searchResultsExperiments(e),searchBarExperiments:P.searchBarExperiments(e),browseExperiments:P.browseExperiments(e),hasFiltersSelected:L.hasFiltersSelected(e),searchUrlReset:L.searchUrlReset(e),preferredEditors:L.preferredEditors(e),experiments:P.experiments(e),shouldRenderTabs:P.shouldRenderTabs(e),filteredContactName:L.filteredContactName(e),shouldRenderInlineSearchFilters:P.shouldRenderInlineSearchFilters(e)}}),te)($);t.ConnectedSearchViewWithProvider=function(e){return a.default.createElement(o.Provider,{store:ee},a.default.createElement(re,r.__assign({},e)))},t.SearchView=g.requireCssWithComponent(t.ConnectedSearchViewWithProvider,["/static/css/search/view-vflcZZEHs.css","/static/css/browse/browse-vflHiwA1M.css","/static/css/browse/files_view-vflIKKAwq.css","/static/css/search/search_results-vflMAMrNK.css"]);var ne=function(e){var t=e.hasFiltersSelected,r=e.resetFiltersUrl,n=e.onResetFilters;return a.default.createElement("div",{className:"search__view search__view--empty",id:"search-view"},a.default.createElement(T.Image,{src:V.static_url("/static/images/empty_states/search-vflHMNVT9.png"),srcHiRes:V.static_url("/static/images/empty_states/search@2x-vfly2B3kk.png")}),a.default.createElement("h2",null,Z._("No results found")),a.default.createElement("span",null,t?Z.intl.formatMessage(Z._("Try <LinkScope>resetting all filters</LinkScope>"),{LinkScope:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("a",{href:r,onClick:se(n)},e)}}):Z._("Try different keywords")))};function se(e){return function(t){t.preventDefault(),e()}}var ie=function(e){var t=e.children,r=e.offset,n=e.responsive,s=e.position,i=void 0===s?0:s,o=e.contentScroll,l=e.simplifiedLockup,c=e.hasTopNotification;return a.default.createElement("div",{className:"search__sticky",style:{top:r+(o?0:k.responsiveHeaderHeight(n,!!l,c)),zIndex:10-i}},t)};t.AsyncErrorComponent=_.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/browse/components/post_tti/error"],t,r)})).then(r.__importStar)];case 1:return[2,t.sent().ErrorComponent]}}))}))},loading:function(){return a.default.createElement("div",null,Z._("Something went wrong. Please reload the page."))},loadError:function(){return a.default.createElement("div",null,Z._("Something went wrong. Please reload the page."))}});var ae=function(){try{return!("msie"===K.get_browser_info().browser&&parseFloat(K.get_browser_info().version)<=11)}catch(e){return!0}}})),define("modules/clean/search/single_page/zero_query/history",["require","exports","tslib","react-redux","react","spectrum/icon_global","spectrum/media_table","spectrum/table","spectrum/tertiary_link","modules/clean/search/single_page/data/action_creators","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/logger","modules/core/i18n","modules/clean/keycode"],(function(e,t,r,n,s,i,a,o,l,c,u,d,p,_,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importDefault(s),c=r.__importStar(c),u=r.__importStar(u),d=r.__importStar(d),p=r.__importStar(p);var g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleHistoryClick=function(e,r){t.props.setQuery({query:e.normalizedQuery,alwaysTriggerSearch:!0}),t.focusInputBox(),p.logHistoryClicked(e.normalizedQuery,r)},t.handleClearClick=function(){t.props.user&&(t.props.clearHistory(),t.focusInputBox())},t.focusInputBox=function(){t.props.inputBox.current&&t.props.inputBox.current.focus()},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.shouldRenderHistory&&p.logHistoryDisplayed(this.props.history)},t.prototype.componentDidUpdate=function(e){this.props.shouldRenderHistory&&e.shouldRenderHistory&&p.logHistoryDisplayed(this.props.history)},t.prototype.render=function(){var e=this,t=this.props,r=t.history;return t.shouldRenderHistory?s.default.createElement(o.Table,{columnFlex:[10,"70px"],"aria-rowcount":r.length,"aria-describedby":"search__history-header"},s.default.createElement(o.TableHead,null,s.default.createElement(o.TableHeadCell,{id:"search__history-header"},_._("Recent searches")),s.default.createElement(o.TableHeadCell,{align:"right"},s.default.createElement(l.TertiaryLink,{onClick:this.handleClearClick,className:"search__history-clear"},_._("Clear all")))),s.default.createElement(o.TableBody,null,r.map((function(t,r){return s.default.createElement(f,{key:"history-"+r,history:t,index:r,onClick:e.handleHistoryClick})})))):null},t})(s.default.PureComponent);t.SearchHistoryComponent=g;var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){t.props.onClick(t.props.history,t.props.index)},t.handleKeyDown=function(e){switch(e.keyCode){case h.KeyCode.SPACE:case h.KeyCode.ENTER:t.props.onClick(t.props.history,t.props.index)}},t}return r.__extends(t,e),t.prototype.render=function(){var e=this;return s.default.createElement(a.MediaRow,{onClick:this.handleClick,className:"search__history-item",tabIndex:0,onKeyDown:this.handleKeyDown},(function(t){var r=t.isHovered;return[s.default.createElement(a.MediaCell,{key:"text",icon:s.default.createElement(i.IconGlobal,{name:"search"}),title:e.props.history.rawQuery,highlight:r})]}))},t})(s.default.PureComponent);t.SearchHistoryRow=f;var m={setQuery:c.setQuery,clearHistory:c.clearAllHistory};t.SearchHistoryView=n.connect((function(e){return{history:d.queryHistory(e),shouldRenderHistory:u.shouldRenderHistory(e),user:d.user(e)}}),m)(g)})),define("modules/clean/search/single_page/zero_query/index",["require","exports","tslib","classnames","react-redux","react","modules/clean/keycode","modules/clean/react/image","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/zero_query/history","modules/clean/static_urls","modules/core/i18n"],(function(e,t,r,n,s,i,a,o,l,c,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),i=r.__importDefault(i),l=r.__importStar(l);var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleKeyDown=function(e){e.keyCode===a.KeyCode.ESC&&t.props.inputBox.current&&t.props.inputBox.current.focus()},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.shouldRenderEmptyZeroQueryView,r=e.inputBox;return i.default.createElement("div",{className:n.default({search__view:!0,"search__view--empty":t}),id:"search-view",onKeyDown:this.handleKeyDown},i.default.createElement(c.SearchHistoryView,{inputBox:r}),t&&i.default.createElement(i.default.Fragment,null,i.default.createElement(o.Image,{role:"presentation",src:u.static_url("/static/images/empty_states/search-vflHMNVT9.png"),srcHiRes:u.static_url("/static/images/empty_states/search@2x-vfly2B3kk.png")}),i.default.createElement("h2",null,d._("Begin typing to search")),i.default.createElement("span",null,d._("Search for files, folders, and content"))))},t})(i.default.PureComponent);t.ZeroQueryComponent=p;t.ZeroQueryView=s.connect((function(e){return{shouldRenderEmptyZeroQueryView:l.shouldRenderEmptyZeroQueryView(e)}}))(p)})),define("retrieval-components/file-type-filter",["require","exports","tslib","tslib","classnames","react","react-aria-menubutton","spectrum/button","spectrum/checkbox","spectrum/dropdown_menu","spectrum/icon_content","spectrum/label","spectrum/modal","spectrum/tooltip"],(function(e,t,r,n,s,i,a,o,l,c,u,d,p,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),s=r.__importDefault(s),i=r.__importStar(i);var h=function(){},g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSelectOrClearAll=function(){var e=t.props,r=e.entries,n=e.checkedCategories,s=e.onChange;v(r,n)?s([]):s(E(r.map((function(e){return e.category}))))},t.handleChange=function(e,r){var n=t.props,s=n.checkedCategories,i=n.onChange,a=s.filter((function(e){return e!==r}));e&&(a=a.concat([r])),i(E(a))},t}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,r=t.strings,s=t.entries,a=t.checkedCategories;return i.createElement("div",{className:"rc-ftf"},i.createElement("header",{className:"rc-ftf-header"},i.createElement("span",{className:"rc-ftf-header__label"},r.byType),i.createElement(o.Button,{variant:"borderless",className:"rc-ftf-header__button",onClick:this.handleSelectOrClearAll},v(s,a)?r.clearAll:r.selectAll)),i.createElement("ul",{className:"rc-ftf-list"},s.map((function(t){return i.createElement(f,n.__assign({key:t.label,category:t.category},t,{checked:a.indexOf(t.category)>-1,onChange:e.handleChange}))}))))},t})(i.Component);t.FileTypeFilter=g;var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleChange=function(e){var r=t.props;(0,r.onChange)("checked"===e,r.category)},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.label,r=e.icon,n=e.checked,a=e.tooltip;return i.createElement("li",null,i.createElement(d.Label,{className:s.default({"rc-ftf-list__row":!0,"rc-ftf-list__row--checked":n}),"aria-label":t},i.createElement(l.Checkbox,{checked:n?"checked":"unchecked",onChange:this.handleChange,name:t,ariaLabel:t}),w(i.createElement("span",{className:"rc-ftf-list__row-name"},t),t),i.createElement(_.Tooltip,{positioning:"left",tooltipContent:a,wrapperClassName:"rc-ftf-list__row-icon"},"string"==typeof r?i.createElement(u.IconContent,{name:r,className:"rc-ftf-list__row-icon-content",role:"presentation"}):r)))},t})(i.Component);t.FileTypeFilterRow=f;var m=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.modalProps,r=n.__rest(e,["modalProps"]),s=(t.ref,n.__rest(t,["ref"]));return i.createElement(p.Modal,n.__assign({overlayClickClose:!0,displayCloseButton:!0},s,{className:"rc-ftf-modal"}),i.createElement("div",{className:"rc-ftf-modal__header"},t.title),i.createElement("div",{className:"rc-ftf-modal__body"},i.createElement(g,n.__assign({},r))))},t})(i.Component);t.FileTypeFilterModal=m;var S=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.entries,r=e.checkedCategories,n=e.strings,s=t.filter((function(e){return r.indexOf(e.category)>-1})),a=s.length?s[0].label:n.byType,o=s.length>1?i.createElement("span",{className:"rc-ftf-dropdown__badge"},s.length):null;return i.createElement("span",{className:"rc-ftf-dropdown__button-content"},w(i.createElement("span",{className:"rc-ftf-dropdown__button-label"},a),a),o)},t})(i.Component);t.FileTypeFilterButtonContent=S;var y=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleOnMenuToggle=function(e){t.props.onMenuToggle&&t.props.onMenuToggle(e.isOpen)},t.handleKeyDown=function(e){switch(e.which){case 38:case 40:return e.preventDefault(),void e.stopPropagation();default:return}},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.onClick,r={className:e.className};return t&&(r.onClick=t),i.createElement(c.DropdownMenu,{onSelection:h,className:"rc-ftf-dropdown",onKeyDown:this.handleKeyDown},i.createElement(a.Wrapper,{onMenuToggle:this.handleOnMenuToggle},i.createElement(c.DropdownMenuButton,n.__assign({},r),i.createElement(S,n.__assign({},this.props))),i.createElement(c.Menu,{className:"rc-ftf-dropdown__menu"},i.createElement(g,n.__assign({},this.props)))))},t})(i.Component);function v(e,t){return e.every((function(e){return t.indexOf(e.category)>-1}))}function E(e){var t=new Set;e.forEach((function(e){return t.add(e)}));var r=[];return t.forEach((function(e){return r.push(e)})),r}function w(e,t){return i.cloneElement(e,{onMouseEnter:function(r){r.currentTarget.title=r.currentTarget.scrollWidth>r.currentTarget.clientWidth?t:"",e.props.onMouseEnter&&e.props.onMouseEnter(r)}})}t.FileTypeFilterDropdown=y,t.areAllEntriesChecked=v,t.areAllEntriesUnchecked=function(e){return 0===e.length}}));
//# sourceMappingURL=pkg-search.min.js-vflsO85_2.map