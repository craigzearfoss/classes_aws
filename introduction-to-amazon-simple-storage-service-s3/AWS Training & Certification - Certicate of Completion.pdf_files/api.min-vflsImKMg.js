define(["require","exports","tslib","modules/clean/api_v2/noauth_client","modules/clean/api_v2/user_client","modules/clean/api_v2/datetime","modules/clean/react/file_transfers/redux/types","file-transfers/common/constants","modules/clean/filepath","modules/clean/viewer","modules/clean/react/file_transfers/constants","modules/clean/react/user_metadata/api","file-transfers/common/types"],(function(e,r,t,n,s,i,a,o,_,c,u,l,f){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),a=t.__importStar(a),r.isApiErrorResult=function(e){return null!=e.error&&null!=e.error.error_type},r.getFolderSizes=function(e,r){return t.__awaiter(this,void 0,Promise,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,(new s.UserApiV2Client).ns("folders_info").rpc("get_folder_sizes",{paths:r},{subjectUserId:e})];case 1:return[2,t.sent()]}}))}))},r.authWithPassword=function(e,r,i){return t.__awaiter(this,void 0,Promise,(function(){var a;return t.__generator(this,(function(t){switch(t.label){case 0:return a={transfer_id:r,password:i},e?[4,(new s.UserApiV2Client).ns("file_transfers").rpc("auth_with_password",a,{subjectUserId:e})]:[3,2];case 1:return[2,t.sent()];case 2:return[4,(new n.NoAuthApiV2Client).ns("file_transfers").rpc("auth_with_password_logged_out",a,{})];case 3:return[2,t.sent()]}}))}))},r.fetchTransfersList=function(e,r,n){return t.__awaiter(this,void 0,Promise,(function(){var i,o,_;return t.__generator(this,(function(t){switch(t.label){case 0:return i=function(e){switch(e){case a.TransferListView.Active:return{".tag":"active"};case a.TransferListView.Expired:return{".tag":"expired"}}},o={requested_count:u.LIST_PAGE_TRANSFERS_PER_REQUEST},n&&(o.cursor_token=n),_={view:i(r),pagination:o},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("list",_,{subjectUserId:e})];case 1:return[2,t.sent()]}}))}))},r.createTransfer=function(e,r){return t.__awaiter(this,void 0,Promise,(function(){var n;return t.__generator(this,(function(t){switch(t.label){case 0:return n={},r&&(n.client_generated_tracking_id=r),[4,(new s.UserApiV2Client).ns("file_transfers").rpc("create",n,{subjectUserId:e})];case 1:return[2,t.sent()]}}))}))},r.fetchFiles=function(e,r){return t.__awaiter(this,void 0,Promise,(function(){var i;return t.__generator(this,(function(t){switch(t.label){case 0:return i={transfer_id:r},e?[4,(new s.UserApiV2Client).ns("file_transfers").rpc("files/list",i,{subjectUserId:e})]:[3,2];case 1:return[2,t.sent()];case 2:return[4,(new n.NoAuthApiV2Client).ns("file_transfers").rpc("files/list_logged_out",i,{})];case 3:return[2,t.sent()]}}))}))},r.downloadFiles=function(e,r,i){return t.__awaiter(this,void 0,Promise,(function(){var a;return t.__generator(this,(function(t){switch(t.label){case 0:return a={transfer_id:r,requested_files_by_id:i},e?[4,(new s.UserApiV2Client).ns("file_transfers").rpc("files/download",a,{subjectUserId:e})]:[3,2];case 1:return[2,t.sent()];case 2:return[4,(new n.NoAuthApiV2Client).ns("file_transfers").rpc("files/download_logged_out",a,{})];case 3:return[2,t.sent()]}}))}))},r.saveToDropbox=function(e,r,n,i,a){return t.__awaiter(this,void 0,Promise,(function(){var o,u,l,f;return t.__generator(this,(function(t){switch(t.label){case 0:return o=new s.UserApiV2Client,u=c.Viewer.get_viewer().get_user_by_id(e),l=n,u.is_cdm_member&&(l=u.cdm_tmf_path+_.normalize(n)),f={transfer_id:r,destination_path:_.normalize(l)+_.normalize(i),requested_files_by_id:a},[4,o.ns("file_transfers").rpc("files/save_to_dropbox",f,{subjectUserId:e})];case 1:return[2,t.sent()]}}))}))},r.addFilesById=function(e,r,n){return t.__awaiter(this,void 0,Promise,(function(){var i;return t.__generator(this,(function(t){switch(t.label){case 0:return i={transfer_id:r||void 0,files_to_add:n},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("files/add_by_id",i,{subjectUserId:e})];case 1:return[2,t.sent()]}}))}))},r.removeFileById=function(e,r,n){return t.__awaiter(this,void 0,Promise,(function(){var i;return t.__generator(this,(function(t){switch(t.label){case 0:return i={transfer_id:r,files_to_remove:n},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("files/remove",i,{subjectUserId:e})];case 1:return[2,t.sent()]}}))}))},r.removeFileByPath=function(e,r,n){return t.__awaiter(this,void 0,Promise,(function(){var i;return t.__generator(this,(function(t){switch(t.label){case 0:return i={transfer_id:r,requested_files_by_path:n},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("files/remove",i,{subjectUserId:e})];case 1:return[2,t.sent()]}}))}))},r.addFilesByBlocks=function(e,r,n){return t.__awaiter(this,void 0,Promise,(function(){var i;return t.__generator(this,(function(t){switch(t.label){case 0:return i={transfer_id:r||void 0,files_to_add:n},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("files/add_by_blocks",i,{subjectUserId:e})];case 1:return[2,t.sent()]}}))}))},r.share=function(e,r){return t.__awaiter(this,void 0,Promise,(function(){var n;return t.__generator(this,(function(t){switch(t.label){case 0:return n={transfer_id:r},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("share",n,{subjectUserId:e})];case 1:return[2,t.sent()]}}))}))},r.updateMetadata=function(e,r,n,a,o){return t.__awaiter(this,void 0,Promise,(function(){var _;return t.__generator(this,(function(t){switch(t.label){case 0:return _={expiration_time_update:{".tag":"expiration_time",expiration_time:i.formatTimestamp(n)},transfer_id:r},void 0!==o&&(_.password_update=""===o?{".tag":"no_password"}:{".tag":"password",password:o}),void 0!==a&&(_.should_notify_creator_on_download_update={".tag":"should_notify_creator_on_download",should_notify_creator_on_download:a}),[4,(new s.UserApiV2Client).ns("file_transfers").rpc("update_metadata",_,{subjectUserId:e})];case 1:return[2,t.sent()]}}))}))},r.updateUserConfig=function(e,r){return t.__awaiter(this,void 0,Promise,(function(){var n;return t.__generator(this,(function(t){switch(t.label){case 0:return n={background_id:r.background_id},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("update_user_config",n,{subjectUserId:e})];case 1:return[2,t.sent()]}}))}))},r.logUserMetricsEvent=function(e,r,i,a){return t.__awaiter(this,void 0,Promise,(function(){var o;return t.__generator(this,(function(t){switch(t.label){case 0:return o={transfer_id:r,event_name:i,recipient_tracking_id:a},e?[4,(new s.UserApiV2Client).ns("file_transfers").rpc("user_metrics/log_event",o,{subjectUserId:e})]:[3,2];case 1:return[2,t.sent()];case 2:return[4,(new n.NoAuthApiV2Client).ns("file_transfers").rpc("user_metrics/log_event_logged_out",o,{})];case 3:return[2,t.sent()]}}))}))},r.deleteTransfer=function(e,r){return t.__awaiter(this,void 0,Promise,(function(){var n;return t.__generator(this,(function(t){switch(t.label){case 0:return n={transfer_id:r},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("delete",n,{subjectUserId:e})];case 1:return[2,t.sent()]}}))}))},r.addRecipientsAndSend=function(e,r,n,i){return t.__awaiter(this,void 0,Promise,(function(){var a;return t.__generator(this,(function(t){switch(t.label){case 0:return a={recipients:r,message_body:n,transfer_id:i},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("recipients/add_and_send",a,{subjectUserId:e})];case 1:return[2,t.sent()]}}))}))},r.submitFeedback=function(e,r,i,a,_,c,u){return t.__awaiter(this,void 0,Promise,(function(){var l,f;return t.__generator(this,(function(t){switch(t.label){case 0:return l=r===o.NOT_APPLICABLE_SATISFACTION_RATING_VALUE?{".tag":"not_applicable"}:{".tag":"value",value:r},f={satisfaction_rating:l,comments:i,file_transfer_flow:a||void 0,transfer_id:_||void 0,client_generated_transfer_tracking_id:c||void 0,platform:u||void 0},e?[4,(new s.UserApiV2Client).ns("file_transfers").rpc("submit_feedback",f,{subjectUserId:e})]:[3,2];case 1:return[2,t.sent()];case 2:return[4,(new n.NoAuthApiV2Client).ns("file_transfers").rpc("submit_feedback_logged_out",f,{})];case 3:return[2,t.sent()]}}))}))},r.logProductAnalyticsEvent=function(e,r){return t.__awaiter(this,void 0,Promise,(function(){var i;return t.__generator(this,(function(t){switch(t.label){case 0:return i={transfer_id:r.transferId,event_name:r.eventName,file_expiration:r.fileExpiration,file_transfer_flow:r.fileTransferFlow,client_generated_transfer_tracking_id:r.clientGeneratedTransferTrackingId,extra:JSON.stringify(r.extra)},e?[4,(new s.UserApiV2Client).ns("file_transfers").rpc("product_analytics/log_event",i,{subjectUserId:e})]:[3,2];case 1:return[2,t.sent()];case 2:return[4,(new n.NoAuthApiV2Client).ns("file_transfers").rpc("product_analytics/log_event_logged_out",i,{})];case 3:return[2,t.sent()]}}))}))},r.teamsOptIn=function(e){return t.__awaiter(this,void 0,Promise,(function(){return t.__generator(this,(function(r){switch(r.label){case 0:return[4,(new s.UserApiV2Client).ns("file_transfers").rpc("teams/opt_in",{},{subjectUserId:e})];case 1:return[2,r.sent()]}}))}))},r.listRecipients=function(e,r){return t.__awaiter(this,void 0,Promise,(function(){var n;return t.__generator(this,(function(t){switch(t.label){case 0:return n={transfer_id:r},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("recipients/list",n,{subjectUserId:e})];case 1:return[2,t.sent()]}}))}))},r.getProductConfig=function(e){return t.__awaiter(this,void 0,Promise,(function(){return t.__generator(this,(function(r){switch(r.label){case 0:return e?[4,(new s.UserApiV2Client).ns("file_transfers").rpc("product_config/get",{},{subjectUserId:e})]:[3,2];case 1:return[2,r.sent()];case 2:return[4,(new n.NoAuthApiV2Client).ns("file_transfers").rpc("product_config/get",{},{})];case 3:return[2,r.sent()]}}))}))},r.getFileTransfersUserMetadata=function(e){var r,n;return t.__awaiter(this,void 0,Promise,(function(){var s;return t.__generator(this,(function(t){switch(t.label){case 0:return[4,l.getUserMetadata(["FILE_TRANSFER_SHOULD_NOTIFY_CREATOR_ON_DOWNLOAD","FILE_TRANSFER_EXPIRATION_OPTION"],e)];case 1:return s=t.sent(),[2,{expirationOption:null!==(r=s.FILE_TRANSFER_EXPIRATION_OPTION)&&void 0!==r?r:f.ExpirationOption.SEVEN_DAYS,shouldNotifyCreatorOnDownload:null===(n=s.FILE_TRANSFER_SHOULD_NOTIFY_CREATOR_ON_DOWNLOAD)||void 0===n||n}]}}))}))}}));
//# sourceMappingURL=api.min.js-vflZAO2p-.map